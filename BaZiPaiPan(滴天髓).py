# -*- coding: utf-8 -*-
import sys
import datetime
from argparse import Namespace
from collections import namedtuple
from lunar_python import Lunar, Solar
import sxtwl  # ç”¨äºå››æŸ±å…«å­—è½¬æ—¥æœŸçš„åº“
from sxtwl import GZ
from prettytable import PrettyTable

# å®šä¹‰ namedtupleï¼Œç”¨äºå­˜å‚¨å››æŸ±å…«å­—çš„å¤©å¹²å’Œåœ°æ”¯
Gans = namedtuple("Gans", "year month day time")
Zhis = namedtuple("Zhis", "year month day time")
å¤©å¹²åˆ—è¡¨ = ["ç”²", "ä¹™", "ä¸™", "ä¸", "æˆŠ", "å·±", "åºš", "è¾›", "å£¬", "ç™¸"]
åœ°æ”¯åˆ—è¡¨ = ["å­", "ä¸‘", "å¯…", "å¯", "è¾°", "å·³", "åˆ", "æœª", "ç”³", "é…‰", "æˆŒ", "äº¥"]
æ¶ˆå¤±å­—å…¸ = {}   #ç”¨äºè®°å½•æ¯ä¸ªæ¶ˆå¤±çš„å¤©å¹²æˆ–åœ°æ”¯ä»¥åŠå…¶æ¶ˆå¤±çš„åŸå› 
è®¡çº§å­—å…¸ = {}
åˆ‘å†²åœ°æ”¯ = set()
åˆå»åœ°æ”¯ = set()
åœ°æ”¯åˆæ¬¡æ•° = {åœ°æ”¯: 0 for åœ°æ”¯ in åœ°æ”¯åˆ—è¡¨}
# å‡è®¾æœ‰ä¸€ä¸ªå¤–éƒ¨çš„ BaZi ç±»å¯ä»¥ç›´æ¥æ ¹æ®å¹²æ”¯æˆ–æ—¥æœŸè®¡ç®—å…«å­—ï¼ˆè¿™åªæ˜¯å ä½ç¤ºä¾‹ï¼‰
class BaZi:
    def __init__(self, year_gz, month_gz, day_gz, time_gz):
        self.year_gan = year_gz[0]
        self.year_zhi = year_gz[1]
        self.month_gan = month_gz[0]
        self.month_zhi = month_gz[1]
        self.day_gan = day_gz[0]
        self.day_zhi = day_gz[1]
        self.time_gan = time_gz[0]
        self.time_zhi = time_gz[1]
    def getYearGan(self):
        return self.year_gan
    def getYearZhi(self):
        return self.year_zhi
    def getMonthGan(self):
        return self.month_gan
    def getMonthZhi(self):
        return self.month_zhi
    def getDayGan(self):
        return self.day_gan
    def getDayZhi(self):
        return self.day_zhi
    def getTimeGan(self):
        return self.time_gan
    def getTimeZhi(self):
        return self.time_zhi

# å®šä¹‰è¾…åŠ©å‡½æ•°ï¼Œç”¨äºæ ¹æ®å¹²æ”¯ç»„åˆï¼ˆå¦‚"ç”²å­"ï¼‰è¿”å›sxtwlåº“æ‰€éœ€çš„å¹²æ”¯ç¼–å·
# æ³¨ï¼šsxtwlä½¿ç”¨å¤©å¹²åœ°æ”¯ä»£å·éœ€é€šè¿‡ getGZ() å‡½æ•°ï¼Œæœ¬å‡½æ•°æ˜¯å ä½ã€‚
def getGZ(gz_str):
    """
    å°†å¹²æ”¯å­—ç¬¦ä¸²è½¬æ¢ä¸ºsxtwl.GZå¯¹è±¡
    ä¾‹å¦‚ï¼š'ç”²å­' -> GZ(0, 0)ï¼Œ'ä¹™ä¸‘' -> GZ(1, 1) ç­‰
    """
    if len(gz_str) != 2:
        raise ValueError(f"å¹²æ”¯å­—ç¬¦ä¸²å¿…é¡»æ˜¯ä¸¤ä¸ªå­—ç¬¦ï¼Œå½“å‰æ˜¯ï¼š{gz_str}")
    å¹² = gz_str[0]
    æ”¯ = gz_str[1]
    å¹²ç´¢å¼• = å¤©å¹²åˆ—è¡¨.index(å¹²)
    æ”¯ç´¢å¼• = åœ°æ”¯åˆ—è¡¨.index(æ”¯) 
    return GZ(å¹²ç´¢å¼•, æ”¯ç´¢å¼•)

def æ ¹æ®å…¬å†æ—¥æœŸè®¡ç®—å…«å­—(options):
    """
    æ ¹æ®å…¬å†æ—¥æœŸï¼ˆoptions.year,options.month,options.day,options.timeï¼‰è®¡ç®—å…«å­—
    
    options.g = True ä»£è¡¨å…¬å†  
    options.b = False ä»£è¡¨éç›´æ¥å…«å­—è¾“å…¥ï¼ˆå³ä½¿ç”¨æ—¥æœŸè½¬æ¢ï¼‰  
    è¾“å…¥æ ¼å¼ï¼š@æœºå™¨äºº ç”· 1992 06 23 22
    """
    solar = Solar.fromYmdHms(int(options.year),
                             int(options.month),
                             int(options.day),
                             int(options.time),
                             0,
                             0)
    lunar = solar.getLunar()
    ba = lunar.getEightChar()  # è·å–å…«å­—ä¿¡æ¯å¯¹è±¡

    æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨ = Gans(
        year=ba.getYearGan(),
        month=ba.getMonthGan(),
        day=ba.getDayGan(),
        time=ba.getTimeGan()
    )
    æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨ = Zhis(
        year=ba.getYearZhi(),
        month=ba.getMonthZhi(),
        day=ba.getDayZhi(),
        time=ba.getTimeZhi()
    )
    return æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨, æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨

def æ ¹æ®å¹²æ”¯ç›´æ¥è®¡ç®—å…«å­—(options):
    """
    æ ¹æ®ç”¨æˆ·ç›´æ¥è¾“å…¥çš„å››æŸ±å¹²æ”¯æ¨æ–­å¯èƒ½çš„å…¬å†æ—¥æœŸï¼Œå†è·å–å…«å­—ã€‚
    """
    # year, month, day, time æ˜¯å¦‚ "ç”²å­"ã€"ä¸™å¯…"è¿™ç±»å¹²æ”¯ç»„åˆ
    year_gz = options.year
    month_gz = options.month
    day_gz = options.day
    time_gz = options.time

    try:
        # å°†å¹²æ”¯å­—ç¬¦ä¸²è½¬æ¢ä¸ºsxtwléœ€è¦çš„æ ¼å¼
        year_gz_index = getGZ(year_gz)
        month_gz_index = getGZ(month_gz)
        day_gz_index = getGZ(day_gz)
        time_gz_index = getGZ(time_gz)
        
        # è°ƒç”¨sxtwlçš„æ–¹æ³•
        jds = sxtwl.siZhu2Year(
            year_gz_index,
            month_gz_index,
            day_gz_index,
            time_gz_index,
            options.start,
            int(options.end))
    except Exception as e:
        print(f"è®¡ç®—ç”Ÿæ—¥æ—¶å‡ºé”™ï¼š{e}")
        sys.exit(1)

    possible_dates = []
    for jd in jds:
        t = sxtwl.JD2DD(jd)
        # sxtwl.JD2DDè¿”å›çš„ t åŒ…å«å…¬å†å¹´Yã€æœˆMã€æ—¥Dã€æ—¶h
        possible_dates.append(datetime.datetime(int(t.Y), int(t.M), int(t.D), int(t.h), 0, 0))

    if not possible_dates:
        print("æœªæ‰¾åˆ°å¯èƒ½çš„ç”Ÿæ—¥")
        sys.exit(1)

    # ç­–ç•¥ï¼šé€‰æ‹©æœ€æ¥è¿‘å½“å‰å¹´ä»½çš„æ—¥æœŸ
    current_year = datetime.datetime.now().year
    chosen_date = min(
        (date for date in possible_dates if date.year <= current_year),
        key=lambda x: abs(x.year - current_year),
        default=possible_dates[0]  # å¦‚æ— æ»¡è¶³æ¡ä»¶ï¼Œåˆ™é»˜è®¤é€‰ç¬¬ä¸€ä¸ª
    )

    # é€‰å®šæ—¥æœŸåï¼Œå†ç”¨è¯¥æ—¥æœŸè®¡ç®—å…«å­—
    solar = Solar.fromYmdHms(chosen_date.year,
                             chosen_date.month,
                             chosen_date.day,
                             chosen_date.hour,
                             0,0)
    lunar = solar.getLunar()
    ba = lunar.getEightChar()

    æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨ = Gans(
        year=ba.getYearGan(),
        month=ba.getMonthGan(),
        day=ba.getDayGan(),
        time=ba.getTimeGan()
    )
    æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨ = Zhis(
        year=ba.getYearZhi(),
        month=ba.getMonthZhi(),
        day=ba.getDayZhi(),
        time=ba.getTimeZhi()
    )
    return æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨, æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨


def è§£æè¾“å…¥å‘½ä»¤():
    """
    ä»å‘½ä»¤è¡Œè§£æç”¨æˆ·è¾“å…¥ã€‚
    å‡è®¾è¾“å…¥æ ¼å¼ä¸ºï¼š
    - å…¬å†è¾“å…¥æ³•ç¤ºä¾‹ï¼š@æœºå™¨äºº ç”· 1990 12 06 22
    - å››æŸ±å…«å­—è¾“å…¥æ³•ç¤ºä¾‹ï¼š@æœºå™¨äºº å¥³ ç”² å­ ä¸™ å¯… ä¸ ä¸‘ æˆŒ äº¥
    """
    # ä»sys.stdinè¯»å–ä¸€è¡Œå‘½ä»¤ï¼Œå¦‚ä¸éœ€è¦äº¤äº’ï¼Œå¯ç›´æ¥ä¼ å…¥sys.argv
    line = sys.stdin.readline().strip()
    if not line:
        print("æœªæ£€æµ‹åˆ°è¾“å…¥ï¼Œè¯·è¾“å…¥å‘½ä»¤")
        sys.exit(1)

    parts = line.split()
    if len(parts) < 3:
        print("è¾“å…¥æ ¼å¼æœ‰è¯¯")
        sys.exit(1)

    # parts[0]åº”ä¸º"@æœºå™¨äºº"
    # parts[1]åº”ä¸º"ç”·"æˆ–"å¥³"
    # parts[2]å¼€å§‹æ ¹æ®æ˜¯å¦æ•°å­—åˆ¤æ–­è¾“å…¥æ–¹å¼
    at_cmd = parts[0]
    gender_str = parts[1]

    if at_cmd != "@æœºå™¨äºº":
        print("æœªæ£€æµ‹åˆ°@æœºå™¨äººæŒ‡ä»¤")
        sys.exit(1)

    options = Namespace()
    # æ€§åˆ«å˜é‡ nï¼ŒTrueä¸ºå¥³ï¼ŒFalseä¸ºç”·
    options.n = (gender_str == "å¥³")

    if parts[2].isdigit():
        # å…¬å†è¾“å…¥æ³•
        if len(parts) != 6:
            print("å…¬å†è¾“å…¥æ³•æ ¼å¼é”™è¯¯ï¼Œè¯·è¾“å…¥@æœºå™¨äºº æ€§åˆ« å¹´ æœˆ æ—¥ æ—¶")
            sys.exit(1)
        options.year = parts[2]
        options.month = parts[3]
        options.day = parts[4]
        options.time = parts[5]
        # å…¬å†è¾“å…¥æ ‡è®°
        options.g = True
        # éç›´æ¥å…«å­—è¾“å…¥
        options.b = False
        # é—°æœˆæ ‡è®°ï¼ˆè¿™é‡Œé»˜è®¤ä¸ºFalseï¼‰
        options.r = False
        # é»˜è®¤èµ·å§‹å’Œç»“æŸå¹´
        options.start = 1850
        options.end = '2030'
    else:
        # å››æŸ±å…«å­—è¾“å…¥æ³•
        if len(parts) < 10:
            print("å››æŸ±å…«å­—è¾“å…¥æ³•æ ¼å¼é”™è¯¯ï¼Œè¯·è¾“å…¥@æœºå™¨äºº æ€§åˆ« å¹´å¹² å¹´æ”¯ æœˆå¹² æœˆæ”¯ æ—¥å¹² æ—¥æ”¯ æ—¶å¹² æ—¶æ”¯")
            sys.exit(1)
        # å¹²æ”¯ç»„åˆ
        å¹´å¹² = parts[2]
        å¹´æ”¯ = parts[3]
        æœˆå¹² = parts[4]
        æœˆæ”¯ = parts[5]
        æ—¥å¹² = parts[6]
        æ—¥æ”¯ = parts[7]
        æ—¶å¹² = parts[8]
        æ—¶æ”¯ = parts[9]
        options.year = å¹´å¹² + å¹´æ”¯
        options.month = æœˆå¹² + æœˆæ”¯
        options.day = æ—¥å¹² + æ—¥æ”¯
        options.time = æ—¶å¹² + æ—¶æ”¯
        # å…¬å†æ ‡è®°ï¼šFalse
        options.g = False
        # ç›´æ¥è¾“å…¥å…«å­—
        options.b = True
        # é—°æœˆæ ‡è®°ï¼ˆè¿™é‡Œé»˜è®¤ä¸ºFalseï¼‰
        options.r = False
        # é»˜è®¤èµ·å§‹å’Œç»“æŸå¹´
        options.start = 1801
        options.end = '2040'
    return options






#çœç•¥å‰é¢çš„è¾“å…¥éƒ¨åˆ†çš„ä»£ç 

åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨ = {"ç”²": "æœ¨", "ä¹™": "æœ¨", "ä¸™": "ç«", "ä¸": "ç«", "æˆŠ": "åœŸ", "å·±": "åœŸ", "åºš": "é‡‘", "è¾›": "é‡‘", "å£¬": "æ°´", "ç™¸": "æ°´"}
åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨ = {"ç”²": ("é˜³", "æœ¨"),"ä¹™": ("é˜´", "æœ¨"),"ä¸™": ("é˜³", "ç«"),"ä¸": ("é˜´", "ç«"),"æˆŠ": ("é˜³", "åœŸ"),"å·±": ("é˜´", "åœŸ"),"åºš": ("é˜³", "é‡‘"),"è¾›": ("é˜´", "é‡‘"),"å£¬": ("é˜³", "æ°´"),"ç™¸": ("é˜´", "æ°´")}
åäºŒåœ°æ”¯äº”è¡Œå¯¹ç…§è¡¨ = {"å­": "æ°´", "ä¸‘": "åœŸ", "å¯…": "æœ¨", "å¯": "æœ¨", "è¾°": "åœŸ", "å·³": "ç«", "åˆ": "ç«", "æœª": "åœŸ", "ç”³": "é‡‘", "é…‰": "é‡‘", "æˆŒ": "åœŸ", "äº¥": "æ°´"}
äº”è¡Œä½œç”¨å…³ç³» = {("é‡‘", "é‡‘"): 'åŒ', ("é‡‘", "æœ¨"): 'å…‹', ("é‡‘", "æ°´"): 'ç”Ÿ', ("é‡‘", "ç«"): 'è€—', ("é‡‘", "åœŸ"): 'æ³„',("æœ¨", "æœ¨"): 'åŒ', ("æœ¨", "åœŸ"): 'å…‹', ("æœ¨", "ç«"): 'ç”Ÿ', ("æœ¨", "é‡‘"): 'è€—', ("æœ¨", "æ°´"): 'æ³„',
("æ°´", "æ°´"): 'åŒ', ("æ°´", "ç«"): 'å…‹', ("æ°´", "æœ¨"): 'ç”Ÿ', ("æ°´", "åœŸ"): 'è€—', ("æ°´", "é‡‘"): 'æ³„',("ç«", "ç«"): 'åŒ', ("ç«", "é‡‘"): 'å…‹', ("ç«", "åœŸ"): 'ç”Ÿ', ("ç«", "æ°´"): 'è€—', ("ç«", "æœ¨"): 'æ³„',
("åœŸ", "åœŸ"): 'åŒ', ("åœŸ", "æ°´"): 'å…‹', ("åœŸ", "é‡‘"): 'ç”Ÿ', ("åœŸ", "æœ¨"): 'è€—', ("åœŸ", "ç«"): 'æ³„'}
def äº”è¡Œä½œç”¨åå¢å‡åŠ›(äº”è¡Œ1, äº”è¡Œ2):
    """
    è®¡ç®—ä¸¤ä¸ªäº”è¡Œå±æ€§ä¹‹é—´çš„ä½œç”¨å…³ç³»å¯¹åŒæ–¹çš„å½±å“
    å‚æ•°:
    äº”è¡Œ1: ä¸»åŠ¨æ–¹çš„äº”è¡Œå±æ€§ (å¦‚"é‡‘")
    äº”è¡Œ2: è¢«åŠ¨æ–¹çš„äº”è¡Œå±æ€§ (å¦‚"æœ¨")
    è¿”å›:
    tuple: (ä¸»åŠ¨æ–¹å½±å“, è¢«åŠ¨æ–¹å½±å“)ï¼Œæ¯ä¸ªå½±å“ä¸º "å¢åŠ›"/"å‡åŠ›"/"ä¸å˜"
    """
    ä½œç”¨ = äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡Œ1, äº”è¡Œ2))
    if not ä½œç”¨:
        return "æœªçŸ¥", "æœªçŸ¥"
    å½±å“å¯¹ç…§ = {
        "ç”Ÿ": ("å‡åŠ›", "å¢åŠ›"),  # Aç”ŸB: Aå‡åŠ›ï¼ŒBå¢åŠ›
        "æ³„": ("å¢åŠ›", "å‡åŠ›"),  # Aæ³„B: Aå¢åŠ›ï¼ŒBå‡åŠ›
        "å…‹": ("ä¸å˜", "å‡åŠ›"),  # Aå…‹B: Aä¸å˜ï¼ŒBå‡åŠ›
    }
    
    return å½±å“å¯¹ç…§.get(ä½œç”¨)

åœ°æ”¯è—å¹²å­—å…¸ = {'å¯…': ['ç”²', 'ä¸™', 'æˆŠ'], 'ç”³': ['åºš', 'å£¬'], 'å·³': ['åºš', 'ä¸™', 'æˆŠ'], 'äº¥': ['å£¬', 'ç”²'],
    'å­': ['ç™¸'], 'åˆ': ['ä¸', 'å·±'], 'å¯': ['ä¹™'], 'é…‰': ['è¾›'],
    'è¾°': ['ä¹™', 'æˆŠ', 'ç™¸'], 'æˆŒ': ['è¾›', 'ä¸', 'æˆŠ'], 'ä¸‘': ['ç™¸', 'è¾›', 'å·±'], 'æœª': ['ä¹™', 'å·±', 'ä¸']}
å››é©¬ = ["å¯…", "ç”³", "å·³", "äº¥"]
å››æ­£ = ["å­", "åˆ", "å¯", "é…‰"]
å››æ­£åœ°æ”¯çš„æœ¬æ°” = {'å­': 'ç™¸', 'åˆ': 'ä¸', 'å¯': 'ä¹™', 'é…‰': 'è¾›'}
å››åº“ = ["è¾°", "æˆŒ", "ä¸‘", "æœª"]
å››åº“åœ°æ”¯çš„æœ¬æ°” = {'è¾°': 'æˆŠ', 'æˆŒ': 'æˆŠ', 'ä¸‘': 'å·±', 'æœª': 'å·±'}
åº“ç¥ = {'è¾°': ['å£¬', 'è¾›'], 'æˆŒ': ['ä¸™', 'æˆŠ', 'ä¹™'],'ä¸‘': ['åºš', 'ä¸', 'å·±'],'æœª': ['ç”²', 'ç™¸']}

ä¸‰ä¼šå±€å­—å…¸ = {'äº¥å¯æœª': ['ç”²', 'ä¹™'], 'äº¥å¯': ['ç”²', 'ä¹™'], 'å¯æœª': ['ç”²', 'ä¹™'], 'äº¥æœª': ['ç”²'],
    'ç”³å­è¾°': ['å£¬', 'ç™¸'], 'ç”³å­': ['å£¬', 'ç™¸'], 'å­è¾°': ['å£¬', 'ç™¸'], 'ç”³è¾°': ['å£¬'],
    'å¯…åˆæˆŒ': ['ä¸™', 'ä¸'], 'å¯…åˆ': ['ä¸™', 'ä¸'], 'åˆæˆŒ': ['ä¸™', 'ä¸'], 'å¯…æˆŒ': ['ä¸™'],
    'å·³é…‰ä¸‘': ['åºš', 'è¾›'], 'å·³é…‰': ['åºš', 'è¾›'], 'é…‰ä¸‘': ['åºš', 'è¾›'], 'å·³ä¸‘': ['åºš']}
ä¸‰ä¼šæ–¹å­—å…¸ = {'äº¥å­ä¸‘': ['å£¬', 'ç™¸'], 'å¯…å¯è¾°': ['ç”²', 'ä¹™'], 'å·³åˆæœª': ['ä¸™', 'ä¸'], 'ç”³é…‰æˆŒ': ['åºš', 'ï¿½ï¿½']}
åœ°æ”¯å…­å†² = {'å­åˆ': 'å†²', 'å¯é…‰': 'å†²', 'å¯…ç”³': 'å†²', 'å·³äº¥': 'å†²', 'è¾°æˆŒ': 'å†²', 'ä¸‘æœª': 'å†²'}
åˆ‘å­—å…¸ = {'å¯…å·³': ['åˆ‘'], 'ä¸‘æˆŒ': ['åˆ‘'], 'æœªæˆŒ': ['åˆ‘'], 'åˆåˆ': ['åˆ‘'], 'é…‰é…‰': ['åˆ‘'], 'äº¥äº¥': ['åˆ‘']}

# å®šä¹‰ä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼Œç”¨äºè®¡ç®—å¤©å¹²æˆ–åœ°æ”¯çš„é˜´é˜³å±æ€§
def å­—çš„é˜´é˜³å±æ€§(item):
    if item in å¤©å¹²åˆ—è¡¨:
        return 'é˜³' if å¤©å¹²åˆ—è¡¨.index(item) % 2 == 0 else 'é˜´'
    elif item in åœ°æ”¯åˆ—è¡¨:
        return 'é˜³' if åœ°æ”¯åˆ—è¡¨.index(item) % 2 == 0 else 'é˜´'
    else:
        return None


# æ£€æŸ¥åœ°æ”¯æ˜¯å¦å†²
def æ£€æŸ¥åœ°æ”¯æ˜¯å¦å†²(åœ°æ”¯ç»„åˆ):
    """
    è¾“å…¥åœ°æ”¯ä½ç½®å’Œåœ°æ”¯ç»„åˆï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å†²å‘ç”Ÿã€‚
    åœ°æ”¯ä½ç½®ï¼šå¦‚ ['å¹´æ”¯', 'æœˆæ”¯', 'æ—¥æ”¯', 'æ—¶æ”¯']
    åœ°æ”¯ç»„åˆï¼šå¦‚ ['å­', 'åˆ', 'å¯', 'é…‰']
    """
    å†²ç»“æœ = []
    for i in range(len(åœ°æ”¯ç»„åˆ) - 1):
        æ”¯1, æ”¯2 = åœ°æ”¯ç»„åˆ[i], åœ°æ”¯ç»„åˆ[i + 1]
        if f"{æ”¯1}{æ”¯2}" in åœ°æ”¯å…­å†² or f"{æ”¯2}{æ”¯1}" in åœ°æ”¯å…­å†²:
            å†²ç»“æœ.append((æ”¯1, æ”¯2))
            å¤„ç†åˆ‘å†²ç»“æœ(æ”¯1, æ”¯2, "å†²")
    return å†²ç»“æœ

def æ£€æŸ¥åœ°æ”¯æ˜¯å¦åˆ‘(åœ°æ”¯ç»„åˆ):
    """
    æ£€æŸ¥åœ°æ”¯æ˜¯å¦åˆ‘å¹¶å¤„ç†ç»“æœ
    """
    åˆ‘ç»“æœ = []
    for i in range(len(åœ°æ”¯ç»„åˆ) - 1):
        æ”¯1, æ”¯2 = åœ°æ”¯ç»„åˆ[i], åœ°æ”¯ç»„åˆ[i + 1]
        if f"{æ”¯1}{æ”¯2}" in åˆ‘å­—å…¸ or f"{æ”¯2}{æ”¯1}" in åˆ‘å­—å…¸:
            åˆ‘ç»“æœ.append((æ”¯1, æ”¯2))
            å¤„ç†åˆ‘å†²ç»“æœ(æ”¯1, æ”¯2, "åˆ‘")  # ä¿®æ­£è¿™é‡Œçš„å‡½æ•°å
    return åˆ‘ç»“æœ

# æ£€æŸ¥ä¸‰ä¼šå±€ä¸­çš„ä¼šå‡ºè€…
def æ£€æŸ¥ä¸‰ä¼šå±€(åœ°æ”¯ç»„åˆ):
    åœ°æ”¯é›†åˆ = set(åœ°æ”¯ç»„åˆ)  # ä½¿ç”¨é›†åˆè¿›è¡ŒåŒ…å«æ£€æŸ¥
    ä¼šå‡ºè€… = []
    # æ£€æŸ¥æ‰€æœ‰å¯èƒ½çš„ä¼šå±€
    for ä¼šå±€, ä¼šå‡º in ä¸‰ä¼šå±€å­—å…¸.items():
        if set(ä¼šå±€) <= åœ°æ”¯é›†åˆ:
            ä¼šå‡ºè€….extend(ä¼šå‡º)
    return list(set(ä¼šå‡ºè€…))  # å»é‡è¿”å›

# æ£€æŸ¥ä¸‰ä¼šæ–¹ä¸­çš„ä¼šå‡ºè€…
def æ£€æŸ¥ä¸‰ä¼šæ–¹(åœ°æ”¯ç»„åˆ, åˆ‘å†²åˆå»åœ°æ”¯):
    åœ°æ”¯é›†åˆ = set(åœ°æ”¯ç»„åˆ)
    ä¼šå‡ºè€… = []

    for ä¸‰ä¼šç»„, ä¼šå‡º in ä¸‰ä¼šæ–¹å­—å…¸.items():
        if set(ä¸‰ä¼šç»„) <= åœ°æ”¯é›†åˆ and not set(ä¸‰ä¼šç»„) & åˆ‘å†²åˆå»åœ°æ”¯:
            ä¼šå‡ºè€….extend(ä¼šå‡º)

    return list(set(ä¼šå‡ºè€…))  # å»é‡è¿”å›

def è·å–åˆ‘å†²åˆå»åœ°æ”¯(åœ°æ”¯ç»„åˆ):
    """è·å–ç›¸é‚»åœ°æ”¯é—´çš„åˆ‘å†²å…³ç³»å¯¼è‡´çš„å¤±æ•ˆåœ°æ”¯"""
    åˆ‘å†²åˆå»åœ°æ”¯ = set()
    for i in range(len(åœ°æ”¯ç»„åˆ) - 1):
        æ”¯1, æ”¯2 = åœ°æ”¯ç»„åˆ[i], åœ°æ”¯ç»„åˆ[i + 1]
        ç»„åˆ1, ç»„åˆ2 = f"{æ”¯1}{æ”¯2}", f"{æ”¯2}{æ”¯1}"
        # æ£€æŸ¥åˆ‘
        if ç»„åˆ1 in åˆ‘å­—å…¸ or ç»„åˆ2 in åˆ‘å­—å…¸:
            åˆ‘å†²åˆå»åœ°æ”¯.update([æ”¯1, æ”¯2])
        # æ£€æŸ¥å†²
        if ç»„åˆ1 in åœ°æ”¯å…­å†² or ç»„åˆ2 in åœ°æ”¯å…­å†²:
            åˆ‘å†²åˆå»åœ°æ”¯.update([æ”¯1, æ”¯2])
    return åˆ‘å†²åˆå»åœ°æ”¯

# å®šä¹‰åœ°æ”¯å¯¹åº”çš„æœ¬æ°”
def å¤„ç†åˆ‘å†²ç»“æœ(åœ°æ”¯1, åœ°æ”¯2, ç±»å‹="åˆ‘", å·²æ¶ˆå¤±åœ°æ”¯=None, å·²æ¶ˆå¤±å¤©å¹²=None):
    if å·²æ¶ˆå¤±åœ°æ”¯ is None:
        å·²æ¶ˆå¤±åœ°æ”¯ = set()
    if å·²æ¶ˆå¤±å¤©å¹² is None:
        å·²æ¶ˆå¤±å¤©å¹² = set()

    # è®°å½•åœ°æ”¯æ¶ˆå¤±çš„åŸå› 
    æ¶ˆå¤±å­—å…¸[åœ°æ”¯1] = f"({åœ°æ”¯1}åœ°æ”¯)"
    æ¶ˆå¤±å­—å…¸[åœ°æ”¯2] = f"({åœ°æ”¯2}åœ°æ”¯)"
    
    # å°†åœ°æ”¯æ·»åŠ åˆ°å·²æ¶ˆå¤±é›†åˆ
    å·²æ¶ˆå¤±åœ°æ”¯.update([åœ°æ”¯1, åœ°æ”¯2])
    
    # å°†åœ°æ”¯æ·»åŠ åˆ°åˆ‘å†²åœ°æ”¯é›†åˆ
    åˆ‘å†²åœ°æ”¯.update([åœ°æ”¯1, åœ°æ”¯2])
    
    # å¤„ç†äººå…ƒ(åœ°æ”¯è—å¹²)å’Œåº“ç¥ï¼Œä½†ä¿ç•™"æœ¬æ°”"
    for åœ°æ”¯ in [åœ°æ”¯1, åœ°æ”¯2]:
        æœ¬æ°” = å››åº“åœ°æ”¯çš„æœ¬æ°”.get(åœ°æ”¯)
        for è—å¹² in åœ°æ”¯è—å¹²å­—å…¸.get(åœ°æ”¯, []):
            if è—å¹² != æœ¬æ°”:
                æ¶ˆå¤±å­—å…¸[è—å¹²] = f"('{åœ°æ”¯}'çš„äººå…ƒ)"
                å·²æ¶ˆå¤±å¤©å¹².add(è—å¹²)
        for åº“ç¥å¹² in åº“ç¥.get(åœ°æ”¯, []):
            æ¶ˆå¤±å­—å…¸[åº“ç¥å¹²] = f"('{åœ°æ”¯}'çš„åº“ç¥)"
            å·²æ¶ˆå¤±å¤©å¹².add(åº“ç¥å¹²)
    
    # å¤„ç†ç‰¹æ®Šæƒ…å†µä¸‹ä½™ä¸‹çš„å¤©å¹²ç­‰çº§
    if ç±»å‹ == "åˆ‘":
        if (åœ°æ”¯1 == "ä¸‘" and åœ°æ”¯2 == "æˆŒ") or (åœ°æ”¯1 == "æˆŒ" and åœ°æ”¯2 == "ä¸‘"):
            è®¡çº§å­—å…¸["å·±"] = "6çº§"
            è®¡çº§å­—å…¸["æˆŠ"] = "6çº§"
        elif (åœ°æ”¯1 == "æœª" and åœ°æ”¯2 == "æˆŒ") or (åœ°æ”¯1 == "æˆŒ" and åœ°æ”¯2 == "æœª"):
            è®¡çº§å­—å…¸["å·±"] = "3çº§"
            è®¡çº§å­—å…¸["æˆŠ"] = "6çº§"
        elif åœ°æ”¯1 == "è¾°" and åœ°æ”¯2 == "è¾°":
            è®¡çº§å­—å…¸["æˆŠ"] = "6çº§"
    
    elif ç±»å‹ == "å†²":
        if (åœ°æ”¯1 == "è¾°" and åœ°æ”¯2 == "æˆŒ") or (åœ°æ”¯1 == "æˆŒ" and åœ°æ”¯2 == "è¾°"):
            è®¡çº§å­—å…¸["æˆŠ"] = "6çº§"
        elif (åœ°æ”¯1 == "ä¸‘" and åœ°æ”¯2 == "æœª") or (åœ°æ”¯1 == "æœª" and åœ°æ”¯2 == "ä¸‘"):
            è®¡çº§å­—å…¸["å·±"] = "6çº§"


# å®šä¹‰å¤©å¹²äº”åˆè§„åˆ™
å¤©å¹²äº”åˆ = {"ç”²å·±", "ä¹™åºš", "ä¸™è¾›", "ä¸å£¬", "æˆŠç™¸"}

def æ£€æŸ¥å¤©å¹²ç›¸é‚»(å¤©å¹²ä½ç½®):
    """
    åˆ¤æ–­ä¸¤ä¸ªå¤©å¹²æ˜¯å¦ç›¸é‚»ï¼Œéµå¾ª"éš”æ—¥å¹²ä¸ä¸ºéš”"åŸåˆ™
    å‚æ•°:
    å¤©å¹²ä½ç½®: ['å¹´å¹²', 'æœˆå¹²', 'æ—¥å¹²', 'æ—¶å¹²']
    è¿”å›: æ‰€æœ‰ç›¸é‚»çš„å¤©å¹²å¯¹
    """
    ç›¸é‚»å¯¹ = []
    # å¹´å¹²å’Œæœˆå¹²ç›¸é‚»
    ç›¸é‚»å¯¹.append(('å¹´å¹²', 'æœˆå¹²'))
    # æœˆå¹²å’Œæ—¶å¹²ç›¸é‚»ï¼ˆéš”æ—¥å¹²ä¸ä¸ºéš”ï¼‰
    ç›¸é‚»å¯¹.append(('æœˆå¹²', 'æ—¶å¹²'))
    return ç›¸é‚»å¯¹


def åˆ¤æ–­å¤©å¹²æœ‰ä¼¤(å¤©å¹², å¤©å¹²ç»„åˆ, ä¼šå‡ºè€…, åœ°æ”¯ç»„åˆ, è—å¹²):
    """
    åˆ¤æ–­å¤©å¹²æ˜¯å¦æœ‰ä¼¤
    å‚æ•°:
    å¤©å¹²: éœ€è¦åˆ¤æ–­çš„å¤©å¹²
    å¤©å¹²ç»„åˆ: å‘½å±€ä¸­çš„å¤©å¹²ï¼ˆé€å¹²ï¼‰
    ä¼šå‡ºè€…: å‘½å±€ä¸­çš„ä¼šå‡ºè€…
    åœ°æ”¯ç»„åˆ: å‘½å±€ä¸­çš„åœ°æ”¯
    è—å¹²: åœ°æ”¯è—å¹²å­—å…¸
    
    è¿”å›: Trueè¡¨ç¤ºæœ‰ä¼¤ï¼ŒFalseè¡¨ç¤ºæ— ä¼¤
    """
    # 1) æ£€æŸ¥æ˜¯å¦è¢«å…¶ä»–é€å¹²åŒæ€§å…‹æ³„
    for å…¶ä»–å¤©å¹² in å¤©å¹²ç»„åˆ:
        if å…¶ä»–å¤©å¹² != å¤©å¹² and åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[å…¶ä»–å¤©å¹²][0] == åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[å¤©å¹²][0]:
            if äº”è¡Œä½œç”¨å…³ç³».get((åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[å…¶ä»–å¤©å¹²], åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[å¤©å¹²])) in ['å…‹', 'æ³„']:
                return True
    
    # 2) æ£€æŸ¥æ˜¯å¦è¢«ä¼šå‡ºè€…åŒæ€§å…‹æ³„
    for ä¼šå‡º in ä¼šå‡ºè€…:
        if åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[ä¼šå‡º][0] == åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[å¤©å¹²][0]:
            if äº”è¡Œä½œç”¨å…³ç³».get((åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[ä¼šå‡º], åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[å¤©å¹²])) in ['å…‹', 'æ³„']:
                return True
    
    # 3) æ£€æŸ¥æ˜¯å¦è¢«åœ°æ”¯æœ¬æ°”åŒæ€§å…‹æ³„
    for åœ°æ”¯ in åœ°æ”¯ç»„åˆ:
        åœ°æ”¯äº”è¡Œ = åäºŒåœ°æ”¯äº”è¡Œå¯¹ç…§è¡¨[åœ°æ”¯]
        # è·å–åœ°æ”¯çš„æœ¬æ°”ï¼ˆä¸åœ°æ”¯äº”è¡Œç›¸åŒçš„è—å¹²ï¼‰
        for è—å¹²å­— in åœ°æ”¯è—å¹²å­—å…¸.get(åœ°æ”¯, []):
            if åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[è—å¹²å­—] == åœ°æ”¯äº”è¡Œ:  # æ˜¯æœ¬æ°”
                if åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[è—å¹²å­—][0] == åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[å¤©å¹²][0]:
                    if äº”è¡Œä½œç”¨å…³ç³».get((åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[è—å¹²å­—], åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[å¤©å¹²])) in ['å…‹', 'æ³„']:
                        return True
    
    return False


def å¤„ç†å¤©å¹²äº”åˆ(å¤©å¹²ç»„åˆ, å¤©å¹²ä½ç½®, ä¼šå‡ºè€…, åœ°æ”¯ç»„åˆ, è—å¹², å·²æ¶ˆå¤±å¤©å¹²):
    """
    å¤„ç†å¤©å¹²äº”åˆå…³ç³»
    å‚æ•°:
    å¤©å¹²ç»„åˆ: å‘½å±€ä¸­çš„å¤©å¹²
    å¤©å¹²ä½ç½®: å¤©å¹²çš„ä½ç½®ä¿¡æ¯
    ä¼šå‡ºè€…: å‘½å±€ä¸­çš„ä¼šå‡ºè€…
    åœ°æ”¯ç»„åˆ: å‘½å±€ä¸­çš„åœ°æ”¯
    è—å¹²: åœ°æ”¯è—å¹²å­—å…¸
    å·²æ¶ˆå¤±å¤©å¹²: setï¼Œè®°å½•å·²æ¶ˆå¤±çš„å¤©å¹²
    
    è¿”å›: åˆç•™é›†åˆå’Œåˆå»é›†åˆ
    """
    åˆç•™ = set()
    åˆå» = set()
    # ä½¿ç”¨å¸ƒå°”æ ‡å¿—è®°å½•æ¯ä¸ªå¤©å¹²çš„åˆçŠ¶æ€ï¼ŒFalseè¡¨ç¤ºåˆå»ï¼ŒTrueè¡¨ç¤ºåˆç•™
    åˆçŠ¶æ€ = {å¤©å¹²: False for å¤©å¹² in å¤©å¹²ç»„åˆ}
    
    # è·å–ç›¸é‚»çš„å¤©å¹²å¯¹
    ç›¸é‚»å¤©å¹²å¯¹ = æ£€æŸ¥å¤©å¹²ç›¸é‚»(å¤©å¹²ä½ç½®)
    
    # æ£€æŸ¥æ¯å¯¹ç›¸é‚»å¤©å¹²æ˜¯å¦æ„æˆäº”åˆ
    for ä½ç½®1, ä½ç½®2 in ç›¸é‚»å¤©å¹²å¯¹:
        ä½ç½®ç´¢å¼• = {'å¹´å¹²': 0, 'æœˆå¹²': 1, 'æ—¥å¹²': 2, 'æ—¶å¹²': 3}
        å¤©å¹²1 = å¤©å¹²ç»„åˆ[ä½ç½®ç´¢å¼•[ä½ç½®1]]
        å¤©å¹²2 = å¤©å¹²ç»„åˆ[ä½ç½®ç´¢å¼•[ä½ç½®2]]
        
        ç»„åˆ = f"{å¤©å¹²1}{å¤©å¹²2}"
        åç»„åˆ = f"{å¤©å¹²2}{å¤©å¹²1}"
        
        # æ£€æŸ¥æ˜¯å¦æ„æˆäº”åˆ
        if ç»„åˆ in å¤©å¹²äº”åˆ or åç»„åˆ in å¤©å¹²äº”åˆ:
            for å¤©å¹² in [å¤©å¹²1, å¤©å¹²2]:
                # åˆ‡æ¢åˆçŠ¶æ€
                åˆçŠ¶æ€[å¤©å¹²] = not åˆçŠ¶æ€[å¤©å¹²]
                if åˆçŠ¶æ€[å¤©å¹²]:
                    åˆç•™.add(å¤©å¹²)
                    åˆå».discard(å¤©å¹²)
                else:
                    åˆå».add(å¤©å¹²)
                    åˆç•™.discard(å¤©å¹²)
    
    # æ›´æ–°æ¶ˆå¤±å­—å…¸å’Œå·²æ¶ˆå¤±å¤©å¹²é›†åˆ
    for å¤©å¹² in åˆå»:
        # æ‰¾å‡ºå¤©å¹²çš„ä½ç½®
        for idx, tg in enumerate(å¤©å¹²ç»„åˆ):
            if tg == å¤©å¹²:
                if idx == 0:
                    ä½ç½® = "å¹´å¹²"
                elif idx == 1:
                    ä½ç½® = "æœˆå¹²"
                elif idx == 2:
                    ä½ç½® = "æ—¥å¹²"
                elif idx == 3:
                    ä½ç½® = "æ—¶å¹²"
                æ¶ˆå¤±å­—å…¸[å¤©å¹²] = f"({ä½ç½®})"
                å·²æ¶ˆå¤±å¤©å¹².add(å¤©å¹²)
                break  # å‡è®¾æ¯ä¸ªå¤©å¹²åªå‡ºç°åœ¨ä¸€ä¸ªä½ç½®
    
    return åˆç•™, åˆå»

# åœ°æ”¯å…­åˆè§„åˆ™
åœ°æ”¯å…­åˆ = {"å­ä¸‘", "å¯…äº¥", "å¯æˆŒ", "è¾°é…‰", "å·³ç”³", "åˆæœª"}

# åˆ¤æ–­ä¸¤ä¸ªåœ°æ”¯æ˜¯å¦ç›¸é‚»
def æ£€æŸ¥åœ°æ”¯ç›¸é‚»(åœ°æ”¯ä½ç½®):
    """
    è¾“å…¥ï¼šåœ°æ”¯ä½ç½®åˆ—è¡¨ï¼Œä¾‹å¦‚ ['å¹´æ”¯', 'æœˆæ”¯', 'æ—¥æ”¯', 'æ—¶æ”¯']
    è¾“å‡ºï¼šæ‰€æœ‰ç›¸é‚»çš„åœ°æ”¯å¯¹åŠå…¶ä½ç½®ç´¢å¼•
    """
    ç›¸é‚»å¯¹ = []
    for i in range(len(åœ°æ”¯ä½ç½®) - 1):
        ç›¸é‚»å¯¹.append((åœ°æ”¯ä½ç½®[i],åœ°æ”¯ä½ç½®[i + 1]))
    return ç›¸é‚»å¯¹

# åˆ¤æ–­åœ°æ”¯æ˜¯å¦æœ‰ä¼¤
def åˆ¤æ–­åœ°æ”¯æœ‰ä¼¤(åœ°æ”¯, å¤©å¹²ç»„åˆ, åœ°æ”¯ç»„åˆ, ä¼šå‡ºè€…, è—å¹², å…­åˆå¯¹):
    """
    åˆ¤æ–­åœ°æ”¯æ˜¯å¦æœ‰ä¼¤
    å‚æ•°:
    åœ°æ”¯: éœ€è¦åˆ¤æ–­çš„åœ°æ”¯
    å¤©å¹²ç»„åˆ: å‘½å±€ä¸­çš„å¤©å¹²
    åœ°æ”¯ç»„åˆ: å‘½å±€ä¸­çš„åœ°æ”¯
    ä¼šå‡ºè€…: å‘½å±€ä¸­çš„ä¼šå‡ºè€…
    è—å¹²: åœ°æ”¯è—å¹²å­—å…¸
    å…­åˆå¯¹: å½“å‰æ­£åœ¨åˆ¤æ–­çš„å…­ï¿½ï¿½ä¸¤ä¸ªåœ°æ”¯

    è¿”å›: Trueè¡¨ç¤ºæœ‰ä¼¤ï¼ŒFalseè¡¨ç¤ºæ— ä¼¤
    """
    # è·å–å½“å‰åœ°æ”¯çš„æœ¬æ°”ï¼ˆä¸åœ°æ”¯äº”è¡Œå±æ€§ç›¸åŒçš„äººå…ƒï¼‰
    æœ¬åœ°æ”¯äº”è¡Œ = åäºŒåœ°æ”¯äº”è¡Œå¯¹ç…§è¡¨[åœ°æ”¯]
    æœ¬æ°”åˆ—è¡¨ = []
    for äººå…ƒ in åœ°æ”¯è—å¹²å­—å…¸.get(åœ°æ”¯, []):
        if åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[äººå…ƒ] == æœ¬åœ°æ”¯äº”è¡Œ:
            æœ¬æ°”åˆ—è¡¨.append(äººå…ƒ)
    
    # 1) æ£€æŸ¥æœ¬æ°”æ˜¯å¦è¢«é€å¹²åŒæ€§å…‹æ³„
    for æœ¬æ°” in æœ¬æ°”åˆ—è¡¨:
        for å¤©å¹² in å¤©å¹²ç»„åˆ:
            if (åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[å¤©å¹²][0] == åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[æœ¬æ°”][0]and 
                äº”è¡Œä½œç”¨å…³ç³».get((åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[å¤©å¹²], åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[æœ¬æ°”])) in ['å…‹', 'æ³„']):
                return True

    # 2) æ£€æŸ¥æœ¬æ°”æ˜¯å¦è¢«ä¼šå‡ºè€…åŒæ€§å…‹æ³„
    for æœ¬æ°” in æœ¬æ°”åˆ—è¡¨:
        for ä¼šå‡º in ä¼šå‡ºè€…:
            if (åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[ä¼šå‡º][0] == åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[æœ¬æ°”][0] and 
                äº”è¡Œä½œç”¨å…³ç³».get((åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[ä¼šå‡º], åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[æœ¬æ°”])) in ['å…‹', 'æ³„']):
                return True

    # 3) æ£€æŸ¥é™¤å…­åˆå¯¹å¤–çš„å…¶ä»–åœ°æ”¯çš„æœ¬æ°”æ˜¯å¦å¯¹è¯¥åœ°æ”¯çš„æœ¬æ°”æœ‰åŒæ€§å…‹æ³„
    for å…¶ä»–åœ°æ”¯ in åœ°æ”¯ç»„åˆ:
        if å…¶ä»–åœ°æ”¯ not in å…­åˆå¯¹:  # æ’é™¤å…­åˆå¯¹ä¸­çš„åœ°æ”¯
            å…¶ä»–æœ¬æ°” = []
            å…¶ä»–åœ°æ”¯äº”è¡Œ = åäºŒåœ°æ”¯äº”è¡Œå¯¹ç…§è¡¨[å…¶ä»–åœ°æ”¯]
            for äººå…ƒ in åœ°æ”¯è—å¹²å­—å…¸.get(å…¶ä»–åœ°æ”¯, []):
                if åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[äººå…ƒ] == å…¶ä»–åœ°æ”¯äº”è¡Œ:
                    å…¶ä»–æœ¬æ°”.append(äººå…ƒ)
            
            for æœ¬æ°” in æœ¬æ°”åˆ—è¡¨:
                for å…¶ä»–æœ¬æ°”å­— in å…¶ä»–æœ¬æ°”:
                    if (åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[å…¶ä»–æœ¬æ°”å­—][0] == åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[æœ¬æ°”][0] and 
                        äº”è¡Œä½œç”¨å…³ç³».get((åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[å…¶ä»–æœ¬æ°”å­—], åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[æœ¬æ°”])) in ['å…‹', 'æ³„']):
                        return True

    # 4) æ£€æŸ¥ä¸ç›¸é‚»åœ°æ”¯æ˜¯å¦æœ‰åˆ‘å†²å…³ç³»
    # éå†æ‰€æœ‰åœ°æ”¯çš„ä½ç½®
    for idx, currentåœ°æ”¯ in enumerate(åœ°æ”¯ç»„åˆ):
        if currentåœ°æ”¯ != åœ°æ”¯:
            continue
        # æ£€æŸ¥å‰ä¸€ä¸ªåœ°æ”¯
        if idx > 0:
            å‰åœ°æ”¯ = åœ°æ”¯ç»„åˆ[idx-1]
            if (f"{åœ°æ”¯}{å‰åœ°æ”¯}" in åˆ‘å­—å…¸ or f"{å‰åœ°æ”¯}{åœ°æ”¯}" in åˆ‘å­—å…¸ or
                f"{åœ°æ”¯}{å‰åœ°æ”¯}" in åœ°æ”¯å…­å†² or f"{å‰åœ°æ”¯}{åœ°æ”¯}" in åœ°æ”¯å…­å†²):
                return True
        
        # æ£€æŸ¥åä¸€ä¸ªåœ°æ”¯
        if idx < len(åœ°æ”¯ç»„åˆ)-1:
            ååœ°æ”¯ = åœ°æ”¯ç»„åˆ[idx+1]
            if (f"{åœ°æ”¯}{ååœ°æ”¯}" in åˆ‘å­—å…¸ or f"{ååœ°æ”¯}{åœ°æ”¯}" in åˆ‘å­—å…¸ or
                f"{åœ°æ”¯}{ååœ°æ”¯}" in åœ°æ”¯å…­å†² or f"{ååœ°æ”¯}{åœ°æ”¯}" in åœ°æ”¯å…­å†²):
                return True

    return False

# æ£€æŸ¥æ˜¯å¦æ»¡è¶³åœ°æ”¯å…­åˆæ¡ä»¶
def å¤„ç†åœ°æ”¯å…­åˆ(å…­åˆå¯¹ç»“æœ, å¤©å¹²ç»„åˆ, åœ°æ”¯ç»„åˆ, ä¼šå‡ºè€…, è—å¹², å·²æ¶ˆå¤±åœ°æ”¯, å·²æ¶ˆå¤±å¤©å¹², åœ°æ”¯åˆæ¬¡æ•°):
    åˆç•™ = set()
    åˆå» = set()
    
    for åœ°æ”¯1, åœ°æ”¯2 in å…­åˆå¯¹ç»“æœ:
        for åœ°æ”¯ in [åœ°æ”¯1, åœ°æ”¯2]:
            if åœ°æ”¯åˆæ¬¡æ•°[åœ°æ”¯] == 0:
                # ç¬¬ä¸€æ¬¡é‡åˆ°å…­åˆï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ä¼¤
                æœ‰ä¼¤ = åˆ¤æ–­åœ°æ”¯æœ‰ä¼¤(åœ°æ”¯, å¤©å¹²ç»„åˆ, åœ°æ”¯ç»„åˆ, ä¼šå‡ºè€…, è—å¹², (åœ°æ”¯1, åœ°æ”¯2))
                if æœ‰ä¼¤:
                    # åˆç•™
                    åˆç•™.add(åœ°æ”¯)
                    print(f"åœ°æ”¯ {åœ°æ”¯} å› æœ‰ä¼¤è€Œåˆç•™")
                else:
                    # åˆå»
                    åˆå».add(åœ°æ”¯)
                    æ¶ˆå¤±å­—å…¸[åœ°æ”¯] = "åˆå»"
                    å·²æ¶ˆå¤±åœ°æ”¯.add(åœ°æ”¯)
                    åˆå»åœ°æ”¯.add(åœ°æ”¯)
                    print(f"åœ°æ”¯ {åœ°æ”¯} å› æ— ä¼¤è€Œåˆå»")
            else:
                # ç¬¬äºŒæ¬¡åŠä»¥åé‡åˆ°å…­åˆï¼Œç›´æ¥åˆå»
                åˆå».add(åœ°æ”¯)
                æ¶ˆå¤±å­—å…¸[åœ°æ”¯] = "åˆå»"
                å·²æ¶ˆå¤±åœ°æ”¯.add(åœ°æ”¯)
                åˆå»åœ°æ”¯.add(åœ°æ”¯)
                print(f"åœ°æ”¯ {åœ°æ”¯} ç¬¬äºŒæ¬¡åˆå»")
            
            # æ›´æ–°åˆæ¬¡æ•°
            åœ°æ”¯åˆæ¬¡æ•°[åœ°æ”¯] += 1
        
        # å¤„ç†åˆå»çš„åœ°æ”¯
        for åœ°æ”¯ in åˆå»:
            # è®°å½•äººå…ƒå’Œåº“ç¥æ¶ˆå¤±
            æœ¬æ°” = å››åº“åœ°æ”¯çš„æœ¬æ°”.get(åœ°æ”¯)
            for è—å¹²å­— in åœ°æ”¯è—å¹²å­—å…¸.get(åœ°æ”¯, []):
                if è—å¹²å­— != æœ¬æ°”:
                    æ¶ˆå¤±å­—å…¸[è—å¹²å­—] = f"('{åœ°æ”¯}'çš„äººå…ƒ)"
                    å·²æ¶ˆå¤±å¤©å¹².add(è—å¹²å­—)
            for åº“ç¥å¹² in åº“ç¥.get(åœ°æ”¯, []):
                æ¶ˆå¤±å­—å…¸[åº“ç¥å¹²] = f"('{åœ°æ”¯}'çš„åº“ç¥)"
                å·²æ¶ˆå¤±å¤©å¹².add(åº“ç¥å¹²)
    
    return åˆç•™, åˆå»


def æŒ‰é¡ºåºå¤„ç†å››æŸ±å…³ç³»(å¤©å¹²ç»„åˆ, åœ°æ”¯ç»„åˆ, å·²æ¶ˆå¤±å¤©å¹², å·²æ¶ˆå¤±åœ°æ”¯, åœ°æ”¯åˆæ¬¡æ•°):
    """
    æŒ‰å¹´â†’æœˆâ†’æ—¥â†’æ—¶çš„é¡ºåºå¤„ç†å››æŸ±å…³ç³»
    """
    print("\nå¼€å§‹å¤„ç†å››æŸ±å…³ç³»...")  # è°ƒè¯•ä¿¡æ¯
    
    æœ‰æ•ˆåœ°æ”¯ = list(åœ°æ”¯ç»„åˆ)
    æœ‰æ•ˆå¤©å¹² = list(å¤©å¹²ç»„åˆ)
    æœ€ç»ˆä¼šå‡ºè€… = []
    å¤„ç†åºåˆ— = [
        (0, 1, "å¹´æœˆ"),  # å¹´æ”¯å’Œæœˆæ”¯
        (1, 2, "æœˆæ—¥"),  # æœˆæ”¯å’Œæ—¥æ”¯
        (2, 3, "æ—¥æ—¶")   # æ—¥æ”¯å’Œæ—¶æ”¯
    ]
    
    for i, j, ä½ç½® in å¤„ç†åºåˆ—:
        æ”¯1, æ”¯2 = æœ‰æ•ˆåœ°æ”¯[i], æœ‰æ•ˆåœ°æ”¯[j]
        print(f"\næ£€æŸ¥{ä½ç½®}å…³ç³»: {æ”¯1}-{æ”¯2}")  # è°ƒè¯•ä¿¡æ¯
        
        if not æ”¯1 or not æ”¯2 or æ”¯1 in å·²æ¶ˆå¤±åœ°æ”¯ or æ”¯2 in å·²æ¶ˆå¤±åœ°æ”¯:
            print(f"è·³è¿‡{ä½ç½®}å¤„ç†ï¼šåœ°æ”¯æ— æ•ˆæˆ–å·²æ¶ˆå¤±")  # è°ƒè¯•ä¿¡æ¯
            continue
            
        # 1. æ£€æŸ¥å…­åˆ
        ç»„åˆ = f"{æ”¯1}{æ”¯2}"
        åç»„åˆ = f"{æ”¯2}{æ”¯1}"
        print(f"æ£€æŸ¥å…­åˆå…³ç³»: {ç»„åˆ} æˆ– {åç»„åˆ}")  # è°ƒè¯•ä¿¡æ¯
        if ç»„åˆ in åœ°æ”¯å…­åˆ or åç»„åˆ in åœ°æ”¯å…­åˆ:
            print(f"å‘ç°å…­åˆå…³ç³»: {ç»„åˆ} æˆ– {åç»„åˆ}")  # è°ƒè¯•ä¿¡æ¯
            å…­åˆå¯¹ç»“æœ = [(æ”¯1, æ”¯2)]
            åˆç•™, åˆå» = å¤„ç†åœ°æ”¯å…­åˆ(
                å…­åˆå¯¹ç»“æœ, å¤©å¹²ç»„åˆ, åœ°æ”¯ç»„åˆ, æœ€ç»ˆä¼šå‡ºè€…, åœ°æ”¯è—å¹²å­—å…¸, å·²æ¶ˆå¤±åœ°æ”¯, å·²æ¶ˆå¤±å¤©å¹², åœ°æ”¯åˆæ¬¡æ•°
            )
            for åœ°æ”¯ in åˆå»:
                print(f"åœ°æ”¯ {åœ°æ”¯} å› å…­åˆè€Œæ¶ˆå¤±")  # è°ƒè¯•ä¿¡æ¯
        
        # 2. æ£€æŸ¥ä¸‰ä¼šå±€
        if i == 0:  # åªåœ¨å¤„ç†å¹´æœˆæ—¶æ£€æŸ¥ä¸‰ä¼šå±€
            ä¼šå‡ºè€… = æ£€æŸ¥ä¸‰ä¼šå±€([æ”¯1, æ”¯2])
            if ä¼šå‡ºè€…:
                æœ€ç»ˆä¼šå‡ºè€….extend(ä¼šå‡ºè€…)
                print(f"å‘ç°ä¸‰ä¼šå±€ä¼šå‡ºè€…: {ä¼šå‡ºè€…}")  # è°ƒè¯•ä¿¡æ¯
    
        # 3. æ£€æŸ¥ä¸‰ä¼šæ–¹
        if i == 0:  # åªåœ¨å¤„ç†å¹´æœˆæ—¶æ£€æŸ¥ä¸‰ä¼šæ–¹
            åˆ‘å†²åˆå»åœ°æ”¯ = è·å–åˆ‘å†²åˆå»åœ°æ”¯([æ”¯1, æ”¯2])
            ä¼šå‡ºè€… = æ£€æŸ¥ä¸‰ä¼šæ–¹([æ”¯1, æ”¯2], åˆ‘å†²åˆå»åœ°æ”¯)
            if ä¼šå‡ºè€…:
                æœ€ç»ˆä¼šå‡ºè€….extend(ä¼šå‡ºè€…)
                print(f"å‘ç°ä¸‰ä¼šæ–¹ä¼šå‡ºè€…: {ä¼šå‡ºè€…}")  # è°ƒè¯•ä¿¡æ¯
    
        # 4. æ£€æŸ¥åˆ‘å†²å…³ç³»
        # æ£€æŸ¥åˆ‘
        if f"{æ”¯1}{æ”¯2}" in åˆ‘å­—å…¸ or f"{æ”¯2}{æ”¯1}" in åˆ‘å­—å…¸:
            print(f"å‘ç°åˆ‘: {æ”¯1}-{æ”¯2}")  # è°ƒè¯•ä¿¡æ¯
            å¤„ç†åˆ‘å†²ç»“æœ(æ”¯1, æ”¯2, "åˆ‘", å·²æ¶ˆå¤±åœ°æ”¯, å·²æ¶ˆå¤±å¤©å¹²)
            print(f"åœ°æ”¯ {æ”¯1} å’Œ {æ”¯2} å› åˆ‘è€Œæ¶ˆå¤±")  # è°ƒè¯•ä¿¡æ¯
            continue
            
        # æ£€æŸ¥å†²
        if f"{æ”¯1}{æ”¯2}" in åœ°æ”¯å…­å†² or f"{æ”¯2}{æ”¯1}" in åœ°æ”¯å…­å†²:
            print(f"å‘ç°å†²: {æ”¯1}-{æ”¯2}")  # è°ƒè¯•ä¿¡æ¯
            å¤„ç†åˆ‘å†²ç»“æœ(æ”¯1, æ”¯2, "å†²", å·²æ¶ˆå¤±åœ°æ”¯, å·²æ¶ˆå¤±å¤©å¹²)
            print(f"åœ°æ”¯ {æ”¯1} å’Œ {æ”¯2} å› å†²è€Œæ¶ˆå¤±")  # è°ƒè¯•ä¿¡æ¯
            continue
    
    print("\nå››æŸ±å…³ç³»å¤„ç†å®Œæˆ")  # è°ƒè¯•ä¿¡æ¯
    return list(set(æœ€ç»ˆä¼šå‡ºè€…))


def æ‰¾å‡ºå®šå±€å­—(å¤©å¹²ç»„åˆ, åœ°æ”¯ç»„åˆ, ä¼šå‡ºä¿¡æ¯, æ¶ˆå¤±å­—å…¸,æ‰“å°ä¿¡æ¯=True):
    """æ‰¾å‡ºå‘½å±€ä¸­çš„å®šå±€å­—"""
    å®šå±€å­—é›†åˆ = set()
    
    # 1. æ·»åŠ æ‰€æœ‰é€å¹²ï¼ˆå¹´å¹²æœˆå¹²æ—¶å¹²ï¼‰
    å¤©å¹²ç»„åˆ_æ— æ—¥å¹² = [å¤©å¹²ç»„åˆ[0], å¤©å¹²ç»„åˆ[1], å¤©å¹²ç»„åˆ[3]]  # åªå–å¹´å¹²ã€æœˆå¹²ã€æ—¶å¹²
    å®šå±€å­—é›†åˆ.update(å¤©å¹²ç»„åˆ_æ— æ—¥å¹²)
    if æ‰“å°ä¿¡æ¯:
        print("\n1. é€å¹²å®šå±€å­—ï¼š", å®šå±€å­—é›†åˆ)
    
    # 2. æ·»åŠ ä¼šå‡ºä¿¡æ¯ä¸­çš„ä¼šå‡ºè€…
    for ä¿¡æ¯ in ä¼šå‡ºä¿¡æ¯:
        ä¼šå‡ºè€… = ä¿¡æ¯.split('(')[0].strip()
        å®šå±€å­—é›†åˆ.add(ä¼šå‡ºè€…)
    if æ‰“å°ä¿¡æ¯:
        print("2. åŠ å…¥ä¼šå‡ºè€…åçš„å®šå±€å­—ï¼š", å®šå±€å­—é›†åˆ)
    
    # 3. æ·»åŠ å››æ­£åœ°æ”¯çš„æœ¬æ°”
    for åœ°æ”¯ in åœ°æ”¯ç»„åˆ:
        if åœ°æ”¯ in å››æ­£:  # å¦‚æœæ˜¯å››æ­£åœ°æ”¯
            if åœ°æ”¯ not in æ¶ˆå¤±å­—å…¸:  # åªæœ‰å½“åœ°æ”¯æ²¡æœ‰æ¶ˆå¤±æ—¶æ‰æ·»åŠ æœ¬æ°”
                for è—å¹² in åœ°æ”¯è—å¹²å­—å…¸.get(åœ°æ”¯, []):
                    if åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[è—å¹²] == åäºŒåœ°æ”¯äº”è¡Œå¯¹ç…§è¡¨[åœ°æ”¯]:  # æ‰¾å‡ºæœ¬æ°”
                        å®šå±€å­—é›†åˆ.add(è—å¹²)
    if æ‰“å°ä¿¡æ¯:
        print("3. åŠ å…¥å››æ­£åœ°æ”¯æœ¬æ°”åçš„å®šå±€å­—ï¼š", å®šå±€å­—é›†åˆ)
    
    # 4. å¤„ç†å››åº“åœ°æ”¯çš„æœ¬æ°”ï¼ˆå½“å››åº“åœ°æ”¯æ¶ˆå¤±æ—¶ï¼‰
    å››åº“æœ¬æ°”å¯¹åº” = {'è¾°': 'æˆŠ', 'æˆŒ': 'æˆŠ', 'ä¸‘': 'å·±', 'æœª': 'å·±'}
    for åœ°æ”¯ in å››åº“:
        if åœ°æ”¯ in æ¶ˆå¤±å­—å…¸:  # å¦‚æœå››åº“åœ°æ”¯æ¶ˆå¤±äº†
            å®šå±€å­—é›†åˆ.add(å››åº“æœ¬æ°”å¯¹åº”[åœ°æ”¯])  # æ·»åŠ å¯¹åº”çš„åœŸå…ƒç´ æœ¬æ°”
    if æ‰“å°ä¿¡æ¯:
        print("4. åŠ å…¥æ¶ˆå¤±çš„å››åº“åœ°æ”¯æœ¬æ°”åçš„å®šå±€å­—ï¼š", å®šå±€å­—é›†åˆ)
    
    # 5å’Œ6. å¤„ç†å››åº“åœ°æ”¯çš„åŠ¨å­—æƒ…å†µ
    å››åº“åœ°æ”¯åˆ—è¡¨ = [æ”¯ for æ”¯ in åœ°æ”¯ç»„åˆ if æ”¯ in å››åº“]  # å…ˆç­›é€‰å‡ºå››åº“åœ°æ”¯
    for åœ°æ”¯ in å››åº“åœ°æ”¯åˆ—è¡¨:  # åªéå†ç­›é€‰å‡ºçš„å››åº“åœ°æ”¯
        if åœ°æ”¯ not in æ¶ˆå¤±å­—å…¸:  # åªå¤„ç†æœªæ¶ˆå¤±çš„å››åº“åœ°æ”¯
            äººå…ƒé›†åˆ = set(åœ°æ”¯è—å¹²å­—å…¸.get(åœ°æ”¯, []))
            åº“ç¥é›†åˆ = set(åº“ç¥.get(åœ°æ”¯, []))
            å…¨éƒ¨å­—é›†åˆ = äººå…ƒé›†åˆ | åº“ç¥é›†åˆ
            if æ‰“å°ä¿¡æ¯:
                print(f"\nå¤„ç†å››åº“åœ°æ”¯{åœ°æ”¯}:")
                print(f"äººå…ƒé›†åˆ: {äººå…ƒé›†åˆ}")
                print(f"åº“ç¥é›†åˆ: {åº“ç¥é›†åˆ}")
                print(f"å…¨éƒ¨å­—é›†åˆ: {å…¨éƒ¨å­—é›†åˆ}")
            
            # æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤
            æœ‰é‡å¤ = False
            for å­— in å…¨éƒ¨å­—é›†åˆ:
                if å­— in å¤©å¹²ç»„åˆ or any(å­— in ä¿¡æ¯ for ä¿¡æ¯ in ä¼šå‡ºä¿¡æ¯):
                    æœ‰é‡å¤ = True
                    å®šå±€å­—é›†åˆ.add(å­—)  # æ·»åŠ é‡å¤çš„å­—ä½œä¸ºåŠ¨å­—
            
            # å¦‚æœæ²¡æœ‰é‡å¤ï¼Œæ·»åŠ åœŸå…ƒç´ æœ¬æ°”
            if not æœ‰é‡å¤:
                å®šå±€å­—é›†åˆ.add(å››åº“æœ¬æ°”å¯¹åº”[åœ°æ”¯])
    if æ‰“å°ä¿¡æ¯:
        print("å®šå±€å­—ï¼š", å®šå±€å­—é›†åˆ)
    
    return å®šå±€å­—é›†åˆ


# åœ¨å‘½å±€æ‰€æœ‰ä¿¡æ¯å±•ç¤ºå‡½æ•°ä¸­æ·»åŠ å®šå±€å­—çš„æ˜¾ç¤º
def å‘½å±€æ‰€æœ‰ä¿¡æ¯å±•ç¤º(æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨, æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨, options, åœ°æ”¯ç»„åˆ, å·²æ¶ˆå¤±å¤©å¹², å·²æ¶ˆå¤±åœ°æ”¯):
    """å±•ç¤ºå‘½å±€çš„æ‰€æœ‰ç›¸å…³ä¿¡æ¯"""
    
    print("\nã€Šå‘½å±€æ‰€æœ‰ä¿¡æ¯å±•ç¤ºã€‹")
    
    # Part1ï¼šåŸºæœ¬ä¿¡æ¯
    print(f"å¤©å¹²å››æŸ±: å››ä¸ªå¤©å¹²(å¹´å¹²='{æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨.year}', "
          f"æœˆå¹²='{æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨.month}', "
          f"æ—¥å¹²='{æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨.day}', "
          f"æ—¶å¹²='{æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨.time}')")
    print(f"åœ°æ”¯å››æŸ±: å››ä¸ªåœ°æ”¯(å¹´æ”¯='{æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨.year}', "
          f"æœˆæ”¯='{æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨.month}', "
          f"æ—¥æ”¯='{æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨.day}', "
          f"æ—¶æ”¯='{æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨.time}')")
    print(f"æ€§åˆ«ï¼š{'å¥³' if options.n else 'ç”·'}")

    # Part2ï¼šäººå…ƒå’Œåº“ç¥
    äººå…ƒä¿¡æ¯ = []
    åº“ç¥ä¿¡æ¯ = []
    for åœ°æ”¯ in åœ°æ”¯ç»„åˆ:  # ä½¿ç”¨ä¼ å…¥çš„åœ°æ”¯ç»„åˆ
        # å¤„ç†äººå…ƒ(åœ°æ”¯è—å¹²)ä¿¡æ¯
        if åœ°æ”¯ in åœ°æ”¯è—å¹²å­—å…¸:
            è—å¹² = åœ°æ”¯è—å¹²å­—å…¸[åœ°æ”¯]
            if è—å¹²:  # å¦‚æœæœ‰è—å¹²
                äººå…ƒä¿¡æ¯.append(f"{','.join(è—å¹²)}(æ ¹:{åœ°æ”¯})")
        # å¤„ç†åº“ç¥ä¿¡æ¯
        if åœ°æ”¯ in åº“ç¥:
            åº“ç¥åˆ—è¡¨ = åº“ç¥[åœ°æ”¯]
            if åº“ç¥åˆ—è¡¨:  # å¦‚æœæœ‰åº“ç¥
                åº“ç¥ä¿¡æ¯.append(f"{','.join(åº“ç¥åˆ—è¡¨)}(æ ¹:{åœ°æ”¯})")
    
    print("äººå…ƒ(åœ°æ”¯è—å¹²)ï¼š" + 'ï¼›'.join(äººå…ƒä¿¡æ¯))
    print("åº“ç¥ï¼š" + 'ï¼›'.join(åº“ç¥ä¿¡æ¯))

    # Part3ï¼šä¼šå‡ºè€…
    if åœ°æ”¯ç»„åˆ:
        ä¼šå‡ºä¿¡æ¯ = []
        # ç›´æ¥ä½¿ç”¨æ£€æŸ¥ä¸‰ä¼šå±€å‡½æ•°çš„ç»“æœ
        ä¼šå‡ºè€… = æ£€æŸ¥ä¸‰ä¼šå±€(åœ°æ”¯ç»„åˆ)
        if ä¼šå‡ºè€…:
            åœ°æ”¯é›†åˆ = set(åœ°æ”¯ç»„åˆ)
            for ä¼šå±€, ä¼šå‡ºåˆ—è¡¨ in ä¸‰ä¼šå±€å­—å…¸.items():
                if set(ä¼šå±€) <= åœ°æ”¯é›†åˆ:
                    for ä¼šå‡º in ä¼šå‡ºåˆ—è¡¨:
                        if ä¼šå‡º in ä¼šå‡ºè€…:
                            ä¼šå‡ºä¿¡æ¯.append(f"{ä¼šå‡º} (ç”±{list(ä¼šå±€)}ä¼šå‡º)")
        
        # ç›´æ¥ä½¿ç”¨æ£€æŸ¥ä¸‰ä¼šæ–¹å‡½æ•°çš„ç»“æœ
        åˆ‘å†²åˆå»åœ°æ”¯ = è·å–åˆ‘å†²åˆå»åœ°æ”¯(åœ°æ”¯ç»„åˆ)
        ä¼šå‡ºè€… = æ£€æŸ¥ä¸‰ä¼šæ–¹(åœ°æ”¯ç»„åˆ, åˆ‘å†²åˆå»åœ°æ”¯)
        if ä¼šå‡ºè€…:
            for ä¸‰ä¼šç»„, ä¼šå‡ºåˆ—è¡¨ in ä¸‰ä¼šæ–¹å­—å…¸.items():
                if set(ä¸‰ä¼šç»„) <= set(åœ°æ”¯ç»„åˆ) and not set(ä¸‰ä¼šç»„) & åˆ‘å†²åˆå»åœ°æ”¯:
                    for ä¼šå‡º in ä¼šå‡ºåˆ—è¡¨:
                        if ä¼šå‡º in ä¼šå‡ºè€…:
                            ä¼šå‡ºä¿¡æ¯.append(f"{ä¼šå‡º}(ç”±{list(ä¸‰ä¼šç»„)}ä¼šå‡º)")
        
        print("ä¼šå‡ºè€…ï¼š" + ('ï¼›  '.join(ä¼šå‡ºä¿¡æ¯) if ä¼šå‡ºä¿¡æ¯ else "æ— ä¼šå‡ºè€…"))

        # æ˜¾ç¤ºæœ¬æ°”ä¿¡æ¯
        æœ¬æ°”ä¿¡æ¯ = []
        
        å®šå±€å­—é›†åˆ = æ‰¾å‡ºå®šå±€å­—(å¤©å¹²ç»„åˆ, åœ°æ”¯ç»„åˆ, ä¼šå‡ºä¿¡æ¯, æ¶ˆå¤±å­—å…¸, æ‰“å°ä¿¡æ¯=False)

        # æ£€æŸ¥å››æ­£åœ°æ”¯çš„æœ¬æ°”
        for åœ°æ”¯ in åœ°æ”¯ç»„åˆ:
            if åœ°æ”¯ in å››æ­£:  # å¦‚æœæ˜¯å››æ­£åœ°æ”¯
                if åœ°æ”¯ not in æ¶ˆå¤±å­—å…¸:  # åªæœ‰å½“åœ°æ”¯æ²¡æœ‰æ¶ˆå¤±æ—¶
                    æœ¬æ°” = å››æ­£åœ°æ”¯çš„æœ¬æ°”[åœ°æ”¯]
                    if æœ¬æ°” in å®šå±€å­—é›†åˆ:
                        æœ¬æ°”ä¿¡æ¯.append(f"{æœ¬æ°”}(æ ¹:{åœ°æ”¯})")
            
        # æ£€æŸ¥å››åº“åœ°æ”¯çš„æœ¬æ°”
        for åœ°æ”¯ in åœ°æ”¯ç»„åˆ:
            if åœ°æ”¯ in å››åº“:  # å¦‚æœæ˜¯å››åº“åœ°æ”¯
                æœ¬æ°” = å››åº“åœ°æ”¯çš„æœ¬æ°”[åœ°æ”¯]
                if æœ¬æ°” in å®šå±€å­—é›†åˆ:
                    æœ¬æ°”ä¿¡æ¯.append(f"{æœ¬æ°”}(æ ¹:{åœ°æ”¯})")
            
        print("æœ¬æ°”ï¼š" + ('ï¼›'.join(æœ¬æ°”ä¿¡æ¯) if æœ¬æ°”ä¿¡æ¯ else "æ— "))
    else:
        print("ä¼šå‡ºè€…ï¼šæœªæä¾›åœ°æ”¯ç»„åˆ")
        print("æœ¬æ°”ï¼šæœªæä¾›åœ°æ”¯ç»„åˆ")



    # Part4ï¼šæ¶ˆå¤±çš„å­—
    if len(æ¶ˆå¤±å­—å…¸) > 0:
        # æŒ‰ç…§æ¶ˆå¤±åŸå› åˆ†ç»„
        åœ°æ”¯æ¶ˆå¤± = []
        äººå…ƒæ¶ˆå¤± = {}  # æ”¹ç”¨å­—å…¸æ¥æ”¶é›†åŒä¸€åœ°æ”¯çš„äººå…ƒ
        åº“ç¥æ¶ˆå¤± = {}  # æ”¹ç”¨å­—å…¸æ¥æ”¶é›†åŒä¸€åœ°æ”¯çš„åº“ç¥
        
        for å­—, åŸå›  in æ¶ˆå¤±å­—å…¸.items():
            if "åœ°æ”¯" in åŸå› :
                # å¯¹äºåœ°æ”¯ï¼Œæ ‡æ³¨æ˜¯å¹´æ”¯/æœˆæ”¯/æ—¥æ”¯/æ—¶æ”¯
                ä½ç½® = ""
                for idx, dz in enumerate(åœ°æ”¯ç»„åˆ):
                    if dz == å­—:
                        if idx == 0:
                            ä½ç½® = "å¹´æ”¯"
                        elif idx == 1:
                            ä½ç½® = "æœˆæ”¯"
                        elif idx == 2:
                            ä½ç½® = "æ—¥æ”¯"
                        elif idx == 3:
                            ä½ç½® = "æ—¶æ”¯"
                        break
                åœ°æ”¯æ¶ˆå¤±.append(f"{å­—}({ä½ç½®})")
            elif "äººå…ƒ" in åŸå› :
                # æå–åœ°æ”¯å
                åœ°æ”¯å = åŸå› .split("'")[1]
                if åœ°æ”¯å not in äººå…ƒæ¶ˆå¤±:
                    äººå…ƒæ¶ˆå¤±[åœ°æ”¯å] = []
                äººå…ƒæ¶ˆå¤±[åœ°æ”¯å].append(å­—)
            elif "åº“ç¥" in åŸå› :
                # æå–åœ°æ”¯å
                åœ°æ”¯å = åŸå› .split("'")[1]
                if åœ°æ”¯å not in åº“ç¥æ¶ˆå¤±:
                    åº“ç¥æ¶ˆå¤±[åœ°æ”¯å] = []
                åº“ç¥æ¶ˆå¤±[åœ°æ”¯å].append(å­—)
        
        è¾“å‡ºç»“æœ = []
        # æ·»åŠ åœ°æ”¯æ¶ˆå¤±ä¿¡æ¯
        if åœ°æ”¯æ¶ˆå¤±:
            è¾“å‡ºç»“æœ.append("ã€".join(åœ°æ”¯æ¶ˆå¤±))
        
        # æ·»åŠ äººå…ƒæ¶ˆå¤±ä¿¡æ¯
        for åœ°æ”¯, äººå…ƒåˆ—è¡¨ in äººå…ƒæ¶ˆå¤±.items():
            è¾“å‡ºç»“æœ.append(f"{','.join(äººå…ƒåˆ—è¡¨)}('{åœ°æ”¯}'çš„äººå…ƒ)")
            
        # æ·»åŠ åº“ç¥æ¶ˆå¤±ä¿¡æ¯
        for åœ°æ”¯, åº“ç¥åˆ—è¡¨ in åº“ç¥æ¶ˆå¤±.items():
            è¾“å‡ºç»“æœ.append(f"{','.join(åº“ç¥åˆ—è¡¨)}('{åœ°æ”¯}'çš„åº“ç¥)")
        
        # æ·»åŠ å·²æ¶ˆå¤±å¤©å¹²ä¿¡æ¯
        if å·²æ¶ˆå¤±å¤©å¹²:
            å¤©å¹²æ¶ˆå¤±ä¿¡æ¯ = [f"{å¤©å¹²} (å·²æ¶ˆå¤±)" for å¤©å¹² in å·²æ¶ˆå¤±å¤©å¹²]
            è¾“å‡ºç»“æœ.append("ï¼›".join(å¤©å¹²æ¶ˆå¤±ä¿¡æ¯))
        
        # æ·»åŠ å·²æ¶ˆå¤±åœ°æ”¯ä¿¡æ¯
        if å·²æ¶ˆå¤±åœ°æ”¯:
            åœ°æ”¯æ¶ˆå¤±ä¿¡æ¯ = [f"{åœ°æ”¯} (å·²æ¶ˆå¤±)" for åœ°æ”¯ in å·²æ¶ˆå¤±åœ°æ”¯]
            è¾“å‡ºç»“æœ.append("ï¼›".join(åœ°æ”¯æ¶ˆå¤±ä¿¡æ¯))
        
        # æ‰“å°æ–°å¢ä¿¡æ¯
        print("æ¶ˆå¤±çš„å­—(åå¤©å¹²å­—): " + ('ï¼› '.join([f"{å¤©å¹²}" for å¤©å¹² in å·²æ¶ˆå¤±å¤©å¹²]) if å·²æ¶ˆå¤±å¤©å¹² else "æ— "))
        print("æ¶ˆå¤±çš„å­—(åäºŒåœ°æ”¯å­—): " + ('ï¼› '.join([f"{åœ°æ”¯}" for åœ°æ”¯ in å·²æ¶ˆå¤±åœ°æ”¯]) if å·²æ¶ˆå¤±åœ°æ”¯ else "æ— "))
        print("åˆ‘å†²: " + ('ï¼› '.join([f"{åœ°æ”¯}" for åœ°æ”¯ in åˆ‘å†²åœ°æ”¯]) if åˆ‘å†²åœ°æ”¯ else "æ— "))
        print("åˆå»: " + ('ï¼› '.join([f"{åœ°æ”¯}" for åœ°æ”¯ in åˆå»åœ°æ”¯]) if åˆå»åœ°æ”¯ else "æ— "))

    # æŒ‰é˜´é˜³å’Œäº”è¡Œå±æ€§æ’åˆ—å®šå±€å­—
    äº”è¡Œé¡ºåº = ['æœ¨', 'ç«', 'åœŸ', 'é‡‘', 'æ°´']
    é˜³å­— = []
    é˜´å­— = []

    # å°†å®šå±€å­—æŒ‰é˜´é˜³åˆ†ç»„
    for å­— in å®šå±€å­—é›†åˆ:
        if å­—çš„é˜´é˜³å±æ€§(å­—) == 'é˜³':
            é˜³å­—.append(å­—)
        else:
            é˜´å­—.append(å­—)

    # æŒ‰äº”è¡Œé¡ºåºæ’åˆ—
    def è·å–äº”è¡Œç´¢å¼•(å­—):
        return äº”è¡Œé¡ºåº.index(åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[å­—])

    é˜³å­—.sort(key=è·å–äº”è¡Œç´¢å¼•)
    é˜´å­—.sort(key=è·å–äº”è¡Œç´¢å¼•)

    # åˆ›å»ºè¡¨æ ¼
    è¡¨æ ¼ = PrettyTable()
    è¡¨æ ¼.field_names = äº”è¡Œé¡ºåº
    è¡¨æ ¼.header = False  # ä¸æ˜¾ç¤ºè¡¨å¤´
    è¡¨æ ¼.border = False  # ä¸æ˜¾ç¤ºè¾¹æ¡†

    # åˆå§‹åŒ–é˜³è¡Œå’Œé˜´è¡Œ
    é˜³è¡Œ = [''] * 5
    é˜´è¡Œ = [''] * 5

    # å¡«å……é˜³å­—
    for å­— in é˜³å­—:
        äº”è¡Œ = åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[å­—]
        ä½ç½® = äº”è¡Œé¡ºåº.index(äº”è¡Œ)
        é˜³è¡Œ[ä½ç½®] = å­—

    # å¡«å……é˜´å­—
    for å­— in é˜´å­—:
        äº”è¡Œ = åå¤©å¹²äº”è¡Œå¯¹ç…§è¡¨[å­—]
        ä½ç½® = äº”è¡Œé¡ºåº.index(äº”è¡Œ)
        é˜´è¡Œ[ä½ç½®] = å­—

    # æ·»åŠ è¡Œåˆ°è¡¨æ ¼
    è¡¨æ ¼.add_row(é˜³è¡Œ)
    è¡¨æ ¼.add_row(é˜´è¡Œ)

    print("ã€å®šå±€å­—ã€‘")
    print(è¡¨æ ¼)

    å®šå±€å­—é›†åˆ = æ‰¾å‡ºå®šå±€å­—(å¤©å¹²ç»„åˆ, åœ°æ”¯ç»„åˆ, ä¼šå‡ºä¿¡æ¯, æ¶ˆå¤±å­—å…¸, æ‰“å°ä¿¡æ¯=True)
    ä½ç½®ä¿¡æ¯ = []
    
    # å¤„ç†é€å¹²
    é€å¹²ä½ç½® = {å¤©å¹²ç»„åˆ[0]: '[å¹´å¹²]',å¤©å¹²ç»„åˆ[1]: '[æœˆå¹²]',å¤©å¹²ç»„åˆ[3]: '[æ—¶å¹²]'}
    
    # å¤„ç†åœ°æ”¯ä½ç½®
    åœ°æ”¯ä½ç½® = {åœ°æ”¯ç»„åˆ[0]: '[å¹´æ”¯]',åœ°æ”¯ç»„åˆ[1]: '[æœˆæ”¯]',åœ°æ”¯ç»„åˆ[2]: '[æ—¥æ”¯]',åœ°æ”¯ç»„åˆ[3]: '[æ—¶æ”¯]'}
    
    å·²å¤„ç†å­— = set()
    for å­— in å®šå±€å­—é›†åˆ:
        if å­— in å·²å¤„ç†å­—:
            continue
            
        # å¦‚æœæ˜¯é€å¹²
        if å­— in é€å¹²ä½ç½®:
            ä½ç½®ä¿¡æ¯.append(f"{å­—}({é€å¹²ä½ç½®[å­—]})")
            å·²å¤„ç†å­—.add(å­—)
            continue
            
        # å¦‚æœæ˜¯ä¼šå‡ºè€…
        ä¼šå‡ºæ ¹ = []
        for ä¿¡æ¯ in ä¼šå‡ºä¿¡æ¯:
            if å­— == ä¿¡æ¯.split('(')[0].strip():
                åœ°æ”¯ä»¬ = eval(ä¿¡æ¯.split('ç”±')[1].split(']')[0] + ']')
                æ ¹ä¿¡æ¯ = []
                for åœ°æ”¯ in åœ°æ”¯ä»¬:
                    if åœ°æ”¯ in åœ°æ”¯ä½ç½®:
                        æ ¹ä¿¡æ¯.append(f"{åœ°æ”¯}{åœ°æ”¯ä½ç½®[åœ°æ”¯]}")
                if æ ¹ä¿¡æ¯:
                    ä¼šå‡ºæ ¹.append(f"{å­—} (æ ¹:{', '.join(æ ¹ä¿¡æ¯)})")
                    å·²å¤„ç†å­—.add(å­—)
                    
        if ä¼šå‡ºæ ¹:
            ä½ç½®ä¿¡æ¯.extend(ä¼šå‡ºæ ¹)
            continue
            
        # å¦‚æœæ˜¯æœ¬æ°”
        for åœ°æ”¯ in åœ°æ”¯ç»„åˆ:
            if (åœ°æ”¯ in å››æ­£ and åœ°æ”¯ not in æ¶ˆå¤±å­—å…¸ and 
                å­— == å››æ­£åœ°æ”¯çš„æœ¬æ°”.get(åœ°æ”¯)) or (
                åœ°æ”¯ in å››åº“ and å­— == å››åº“åœ°æ”¯çš„æœ¬æ°”.get(åœ°æ”¯)):
                ä½ç½®ä¿¡æ¯.append(f"{å­—}(æ ¹:{åœ°æ”¯}{åœ°æ”¯ä½ç½®[åœ°æ”¯]})")
                å·²å¤„ç†å­—.add(å­—)
                break
    
    print('ï¼›  '.join(ä½ç½®ä¿¡æ¯))


    # ä½ç½®æ˜ å°„å­—å…¸
    ä½ç½®å¯¹åº”è¡¨ = {'å¹´æ”¯': 0, 'æœˆæ”¯': 1, 'æ—¥æ”¯': 2, 'æ—¶æ”¯': 3, 'å¹´å¹²': 0, 'æœˆå¹²': 1, 'æ—¥å¹²': 2, 'æ—¶å¹²': 3}
    # ç®€åŒ–ä½ç½®åç§°
    ç®€åŒ–ä½ç½®å = {0: '[å¹´]', 1: '[æœˆ]', 2: '[æ—¥]', 3: '[æ—¶]'}
    # æ”¶é›†æ¯ä¸ªå­—çš„ä½ç½®ä¿¡æ¯
    å­—çš„ä½ç½®é›†åˆ = {}
    
    import re
    for è¡Œ in ä½ç½®ä¿¡æ¯:
        # åˆ†ç¦»å­—å’Œä½ç½®ä¿¡æ¯
        å­—éƒ¨åˆ†, åˆ†éš”, æ‹¬å·éƒ¨åˆ† = è¡Œ.partition("(")
        å­— = å­—éƒ¨åˆ†.strip(" ï¼›")
        æ‹¬å·éƒ¨åˆ† = æ‹¬å·éƒ¨åˆ†.strip(")ï¼› ")
        
        # æ‰¾å‡ºæ‰€æœ‰[...]ä¸­çš„å†…å®¹
        æ‰€æœ‰æ‹¬å· = re.findall(r'\[(.*?)\]', æ‹¬å·éƒ¨åˆ†)
        
        # æ‰¾å‡ºæœ€é åçš„ä½ç½®
        æœ€å¤§ä½ç½®å€¼ = -1
        for ä½ç½®å in æ‰€æœ‰æ‹¬å·:
            ä½ç½®å€¼ = ä½ç½®å¯¹åº”è¡¨.get(ä½ç½®å, -1)
            if ä½ç½®å€¼ > æœ€å¤§ä½ç½®å€¼:
                æœ€å¤§ä½ç½®å€¼ = ä½ç½®å€¼
        
        # è®°å½•ä½ç½®ä¿¡æ¯
        if å­— not in å­—çš„ä½ç½®é›†åˆ:
            å­—çš„ä½ç½®é›†åˆ[å­—] = []
        å­—çš„ä½ç½®é›†åˆ[å­—].append(æœ€å¤§ä½ç½®å€¼)
    
    # ç¡®å®šæœ€ç»ˆä½ç½®
    æœ€ç»ˆä½ç½® = {}
    for å­—, ä½ç½®åˆ—è¡¨ in å­—çš„ä½ç½®é›†åˆ.items():
        if not ä½ç½®åˆ—è¡¨:
            continue
        é€‰å®šä½ç½®å€¼ = min(ä½ç½®åˆ—è¡¨)  # é€‰æœ€é å‰çš„ä½ç½®
        ä½ç½®å­—ç¬¦ä¸² = ç®€åŒ–ä½ç½®å.get(é€‰å®šä½ç½®å€¼, '[æ— ]')
        æœ€ç»ˆä½ç½®[å­—] = ä½ç½®å­—ç¬¦ä¸²
    
    print("\næ»¡è¶³æ¡ä»¶çš„æœ€åä¸€ä¸ªä½ç½®ï¼š")
    for å­— in sorted(æœ€ç»ˆä½ç½®.keys()):
        print(f"{å­—}ï¼š{æœ€ç»ˆä½ç½®[å­—]}")




import itertools

# å®šä¹‰ä½œç”¨çš„åˆ†æ•°å˜åŒ–
ä½œç”¨åˆ†æ•° = {
    'ç”Ÿ': {'å‡åˆ†': 1.0, 'å¢åˆ†': 1.0},
    'å…‹': {'å‡åˆ†': 0.0, 'å¢åˆ†': -1.0},
    'è€—': {'å‡åˆ†': 0.6, 'å¢åˆ†': 0.0},
    'æ³„': {'å‡åˆ†': 1.0, 'å¢åˆ†': 0.0},  # æ³„æŒ‰ä¸ç”Ÿç±»ä¼¼å¤„ç†
    'åŒ': {'å‡åˆ†': 0.5, 'å¢åˆ†': 0.0}   # 'åŒ'çš„å¤„ç†éœ€è¦ç‰¹æ®Šé€»è¾‘
}

# ä½ç½®é¡ºåºçš„å®šä¹‰
ä½ç½®é¡ºåº = {"å¹´": 1, "æœˆ": 2, "æ—¥": 3, "æ—¶": 4}

# åˆå§‹åŒ–åˆ†æ•°
def åˆå§‹åŒ–åˆ†æ•°(å®šå±€å­—):
    return {å­—: 1.0 for å­— in å®šå±€å­—}

# è¯†åˆ«æ‰€æœ‰â€œåŒâ€ç»„åˆ
def è¯†åˆ«åŒç»„åˆ(å®šå±€å­—):
    åŒç»„åˆ = []
    for A, B in itertools.combinations(å®šå±€å­—, 2):
        äº”è¡ŒA = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[A][1]
        äº”è¡ŒB = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[B][1]
        if äº”è¡ŒA == äº”è¡ŒB and äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡ŒA, äº”è¡ŒB)) == 'åŒ':
            åŒç»„åˆ.append((A, B))
    return åŒç»„åˆ

# å¤„ç†â€œåŒâ€ç»„åˆ
def å¤„ç†åŒç»„åˆ(å®šå±€å­—, scores, ä½œç”¨å€¼):
    åŒç»„åˆ = è¯†åˆ«åŒç»„åˆ(å®šå±€å­—)
    if not åŒç»„åˆ:
        print("æ²¡æœ‰å‘ç°'åŒ'ç»„åˆã€‚")
        return åŒç»„åˆ

    print(f"å‘ç°'åŒ'ç»„åˆ: {åŒç»„åˆ}")

    # å¦‚æœæœ‰å¤šä¸ªâ€œåŒâ€ç»„åˆ
    if len(åŒç»„åˆ) > 1:
        print("æœ‰å¤šä¸ª'åŒ'ç»„åˆï¼Œè¿›è¡Œæ£€æŸ¥æ˜¯å¦èƒ½è¢«å…¶ä»–å­—å…‹æˆ–æ³„ã€‚")
        for ç»„ in åŒç»„åˆ:
            A, B = ç»„
            è¢«å…‹æˆ–æ³„ = False
            for å­— in å®šå±€å­—:
                if å­— not in ç»„:
                    äº”è¡Œå­— = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[å­—][1]
                    # æ£€æŸ¥å­—æ˜¯å¦å…‹æˆ–æ³„ A æˆ– B
                    if äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡Œå­—, åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[A][1])) in ['å…‹', 'æ³„'] or \
                       äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡Œå­—, åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[B][1])) in ['å…‹', 'æ³„']:
                        è¢«å…‹æˆ–æ³„ = True
                        print(f"å­—'{å­—}' èƒ½å…‹æˆ–æ³„ç»„åˆ{ç»„}ä¸­çš„ä¸€ä¸ªå­—ã€‚")
                        break
            if not è¢«å…‹æˆ–æ³„:
                # è¯¥ç»„â€œåŒâ€æ— æ³•è¢«å…‹æˆ–æ³„ï¼Œæ— æ³•è§£é™¤å°å°
                print(f"ç»„åˆ{ç»„}æ— æ³•è¢«ä»»ä½•å­—å…‹æˆ–æ³„ï¼Œæ— æ³•è§£é™¤å°å°ã€‚")
                return "å®šå±€å­—é‡Œæ²¡æœ‰æ ¼ç¥ğŸ˜•"

        # å¦‚æœæ‰€æœ‰â€œåŒâ€ç»„åˆéƒ½èƒ½è¢«å…‹æˆ–æ³„ï¼Œåˆ™æ— æ ¼ç¥
        print("æ‰€æœ‰'åŒ'ç»„åˆéƒ½èƒ½è¢«å…‹æˆ–æ³„ï¼Œæ— æ³•ç¡®å®šæ ¼ç¥ã€‚")
        return "å®šå±€å­—é‡Œæ²¡æœ‰æ ¼ç¥ğŸ˜•"

    # åªæœ‰ä¸€ä¸ªâ€œåŒâ€ç»„åˆ
    if len(åŒç»„åˆ) == 1:
        A, B = åŒç»„åˆ[0]
        print(f"åªæœ‰ä¸€ä¸ª'åŒ'ç»„åˆ: {A} å’Œ {B}ï¼Œå°†å…¶åˆ†æ•°å’Œä½œç”¨å€¼é™ä¸º50%ã€‚")
        scores[A] *= 0.5
        scores[B] *= 0.5
        ä½œç”¨å€¼[A] *= 0.5
        ä½œç”¨å€¼[B] *= 0.5
    return åŒç»„åˆ

# åº”ç”¨ä½œç”¨è§„åˆ™
def åº”ç”¨ä½œç”¨(å®šå±€å­—, scores, ä½œç”¨å€¼):
    print("å¼€å§‹åº”ç”¨ä½œç”¨è§„åˆ™ã€‚")
    for A, B in itertools.permutations(å®šå±€å­—, 2):
        äº”è¡ŒA = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[A][1]
        äº”è¡ŒB = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[B][1]
        å…³ç³» = äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡ŒA, äº”è¡ŒB))
        if not å…³ç³»:
            continue
        # æ£€æŸ¥é˜´é˜³å±æ€§æ˜¯å¦ç›¸åŒ
        é˜´é˜³ç›¸åŒ = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[A][0] == åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[B][0]
        if not é˜´é˜³ç›¸åŒ:
            å½“å‰ä½œç”¨å€¼ = ä½œç”¨å€¼[A] * 0.3  # å¼‚æ€§ä½œç”¨é™ä¸º30%
        else:
            å½“å‰ä½œç”¨å€¼ = ä½œç”¨å€¼[A]
        # æ ¹æ®å…³ç³»è°ƒæ•´åˆ†æ•°
        if å…³ç³» == 'ç”Ÿ':
            scores[A] -= ä½œç”¨åˆ†æ•°['ç”Ÿ']['å‡åˆ†'] * å½“å‰ä½œç”¨å€¼
            scores[B] += ä½œç”¨åˆ†æ•°['ç”Ÿ']['å¢åˆ†'] * å½“å‰ä½œç”¨å€¼
            print(f"{A} ç”Ÿ {B}ï¼š{A} å‡{ä½œç”¨åˆ†æ•°['ç”Ÿ']['å‡åˆ†'] * å½“å‰ä½œç”¨å€¼}ï¼Œ{B} å¢{ä½œç”¨åˆ†æ•°['ç”Ÿ']['å¢åˆ†'] * å½“å‰ä½œç”¨å€¼}")
        elif å…³ç³» == 'å…‹':
            scores[B] += ä½œç”¨åˆ†æ•°['å…‹']['å¢åˆ†'] * å½“å‰ä½œç”¨å€¼
            print(f"{A} å…‹ {B}ï¼š{B} å‡{abs(ä½œç”¨åˆ†æ•°['å…‹']['å¢åˆ†'] * å½“å‰ä½œç”¨å€¼)}")
        elif å…³ç³» == 'è€—':
            scores[A] -= ä½œç”¨åˆ†æ•°['è€—']['å‡åˆ†'] * å½“å‰ä½œç”¨å€¼
            print(f"{A} è€— {B}ï¼š{A} å‡{ä½œç”¨åˆ†æ•°['è€—']['å‡åˆ†'] * å½“å‰ä½œç”¨å€¼}")
        elif å…³ç³» == 'æ³„':
            scores[A] -= ä½œç”¨åˆ†æ•°['æ³„']['å‡åˆ†'] * å½“å‰ä½œç”¨å€¼
            print(f"{A} æ³„ {B}ï¼š{A} å‡{ä½œç”¨åˆ†æ•°['æ³„']['å‡åˆ†'] * å½“å‰ä½œç”¨å€¼}")
    return scores

# åˆ¤æ–­å¹¶ç¡®å®šâ€œæ ¼ç¥â€
def ç¡®å®šæ ¼ç¥(å®šå±€å­—, scores, åŒç»„åˆ, æœ€ç»ˆä½ç½®):
    print("å¼€å§‹ç¡®å®šæ ¼ç¥ã€‚")
    if isinstance(åŒç»„åˆ, str):
        print(åŒç»„åˆ)
        return åŒç»„åˆ

    if åŒç»„åˆ:
        # åªæœ‰ä¸€ç»„â€œåŒâ€ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰ä¸€æ–¹è¢«å…‹æˆ–æ³„
        A, B = åŒç»„åˆ[0]
        print(f"åˆ¤æ–­'åŒ'ç»„åˆå†…çš„å­—æ˜¯å¦è¢«å…‹æˆ–æ³„ï¼š{A} å’Œ {B}")
        Aæ˜¯å¦è¢«å…‹æ³„ = False
        Bæ˜¯å¦è¢«å…‹æ³„ = False
        for å­— in å®šå±€å­—:
            if å­— != A and å­— != B:
                äº”è¡Œå­— = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[å­—][1]
                å…³ç³»å…‹A = äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡Œå­—, åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[A][1]))
                å…³ç³»å…‹B = äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡Œå­—, åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[B][1]))
                if å…³ç³»å…‹A in ['å…‹', 'æ³„']:
                    Aæ˜¯å¦è¢«å…‹æ³„ = True
                    print(f"å­—'{å­—}' èƒ½å…‹æˆ–æ³„ '{A}'ã€‚")
                if å…³ç³»å…‹B in ['å…‹', 'æ³„']:
                    Bæ˜¯å¦è¢«å…‹æ³„ = True
                    print(f"å­—'{å­—}' èƒ½å…‹æˆ–æ³„ '{B}'ã€‚")

        # åˆ¤æ–­æƒ…å†µ
        if Aæ˜¯å¦è¢«å…‹æ³„ and not Bæ˜¯å¦è¢«å…‹æ³„:
            # Bå¹¸å­˜ï¼Œæˆä¸ºæ ¼ç¥
            print(f"å­—'{B}' åœ¨'åŒ'ç»„åˆä¸­å¹¸å­˜ï¼Œæˆä¸ºæ ¼ç¥ã€‚")
            return f"æ ¼ç¥æ˜¯: {B}"
        elif Bæ˜¯å¦è¢«å…‹æ³„ and not Aæ˜¯å¦è¢«å…‹æ³„:
            # Aå¹¸å­˜ï¼Œæˆä¸ºæ ¼ç¥
            print(f"å­—'{A}' åœ¨'åŒ'ç»„åˆä¸­å¹¸å­˜ï¼Œæˆä¸ºæ ¼ç¥ã€‚")
            return f"æ ¼ç¥æ˜¯: {A}"
        elif not Aæ˜¯å¦è¢«å…‹æ³„ and not Bæ˜¯å¦è¢«å…‹æ³„:
            # ä¸¤è€…éƒ½æœªè¢«å…‹æ³„ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰å…¶ä»–å­—å¯ä»¥æˆä¸ºæ ¼ç¥
            print(f"å­—'{A}' å’Œ '{B}' éƒ½æœªè¢«å…‹æˆ–æ³„ï¼ŒæŸ¥çœ‹å…¶ä»–å­—ã€‚")
            max_score = max(scores.values())
            æ ¼ç¥å€™é€‰ = [å­— for å­—, åˆ†æ•° in scores.items() if åˆ†æ•° == max_score and å­— not in [A, B]]
            if len(æ ¼ç¥å€™é€‰) == 1:
                print(f"é€‰æ‹©å¾—åˆ†æœ€é«˜çš„å­—ä½œä¸ºæ ¼ç¥: {æ ¼ç¥å€™é€‰[0]}")
                return f"æ ¼ç¥æ˜¯: {æ ¼ç¥å€™é€‰[0]}"
            else:
                print("æ²¡æœ‰å”¯ä¸€çš„æ ¼ç¥ï¼Œæ— æ³•ç¡®å®šã€‚")
                return "å®šå±€å­—é‡Œæ²¡æœ‰æ ¼ç¥ğŸ˜•"
        else:
            # ä¸¤è€…éƒ½è¢«å…‹æ³„ï¼Œæ²¡æœ‰æ ¼ç¥
            print(f"å­—'{A}' å’Œ '{B}' éƒ½è¢«å…‹æˆ–æ³„ï¼Œæ²¡æœ‰æ ¼ç¥ã€‚")
            return "å®šå±€å­—é‡Œæ²¡æœ‰æ ¼ç¥ğŸ˜•"
    else:
        # æ— â€œåŒâ€ç»„åˆï¼Œåº”ç”¨ä¸‰ç§å®šæ ¼ç¥çš„æ–¹æ³•
        print("æ— 'åŒ'ç»„åˆï¼Œåº”ç”¨ä¸‰ç§å®šæ ¼ç¥çš„æ–¹æ³•ã€‚")
        # æ–¹æ³•2: å›èµ–è‡£ç”Ÿå‹
        for A, B in itertools.permutations(å®šå±€å­—, 2):
            äº”è¡ŒA = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[A][1]
            äº”è¡ŒB = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[B][1]
            å…³ç³» = äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡ŒA, äº”è¡ŒB))
            if å…³ç³» == 'ç”Ÿ':
                print(f"åº”ç”¨å›èµ–è‡£ç”Ÿå‹ï¼š{A} ç”Ÿ {B}ï¼Œå› æ­¤ {B} æ˜¯æ ¼ç¥ã€‚")
                return f"æ ¼ç¥æ˜¯: {B}"

        # æ–¹æ³•3: å„¿èƒ½æ•‘æ¯å‹
        for A, B, C in itertools.permutations(å®šå±€å­—, 3):
            äº”è¡ŒA = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[A][1]
            äº”è¡ŒB = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[B][1]
            äº”è¡ŒC = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[C][1]
            å…³ç³»AB = äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡ŒA, äº”è¡ŒB))
            å…³ç³»BC = äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡ŒB, äº”è¡ŒC))
            if å…³ç³»AB in ['å…‹', 'æ³„'] and å…³ç³»BC in ['å…‹', 'æ³„']:
                print(f"åº”ç”¨å„¿èƒ½æ•‘æ¯å‹ï¼š{A} {å…³ç³»AB} {B}ï¼Œ{B} {å…³ç³»BC} {C}ï¼Œå› æ­¤ {A} æ˜¯æ ¼ç¥ã€‚")
                return f"æ ¼ç¥æ˜¯: {A}"

        # æ–¹æ³•4: æ¯æ…ˆç­å­å‹
        for A, B, C in itertools.permutations(å®šå±€å­—, 3):
            äº”è¡ŒA = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[A][1]
            äº”è¡ŒB = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[B][1]
            äº”è¡ŒC = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[C][1]
            å…³ç³»AB = äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡ŒA, äº”è¡ŒB))
            å…³ç³»BC = äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡ŒB, äº”è¡ŒC))
            å…³ç³»AC = äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡ŒA, äº”è¡ŒC))
            if å…³ç³»AB == 'ç”Ÿ' and å…³ç³»BC == 'ç”Ÿ' and å…³ç³»AC in ['å…‹', 'æ³„']:
                print(f"åº”ç”¨æ¯æ…ˆç­å­å‹ï¼š{A} ç”Ÿ {B}ï¼Œ{B} ç”Ÿ {C}ï¼Œ{A} {å…³ç³»AC} {C}ï¼Œå› æ­¤ {B} æ˜¯æ ¼ç¥ã€‚")
                return f"æ ¼ç¥æ˜¯: {B}"

        # å¦‚æœä¸ç¬¦åˆä»»ä½•æ–¹æ³•ï¼Œé€‰æ‹©å¾—åˆ†æœ€é«˜çš„å­—
        print("ä¸ç¬¦åˆä»»ä½•å®šæ ¼ç¥æ–¹æ³•ï¼Œé€‰æ‹©å¾—åˆ†æœ€é«˜çš„å­—ã€‚")
        max_score = max(scores.values())
        æ ¼ç¥å€™é€‰ = [å­— for å­—, åˆ†æ•° in scores.items() if åˆ†æ•° == max_score]
        if len(æ ¼ç¥å€™é€‰) == 1:
            print(f"é€‰æ‹©å¾—åˆ†æœ€é«˜çš„å­—ä½œä¸ºæ ¼ç¥: {æ ¼ç¥å€™é€‰[0]}")
            return f"æ ¼ç¥æ˜¯: {æ ¼ç¥å€™é€‰[0]}"
        else:
            print("æ²¡æœ‰å”¯ä¸€çš„æ ¼ç¥ï¼Œæ— æ³•ç¡®å®šã€‚")
            return "å®šå±€å­—é‡Œæ²¡æœ‰æ ¼ç¥ğŸ˜•"
    
    print("å®Œæˆç¡®å®šæ ¼ç¥ã€‚")
    return æ ¼ç¥_result


# éªŒè¯æ ¼ç¥çš„æœ‰æ•ˆæ€§ï¼Œè€ƒè™‘ä½ç½®é¡ºåº
def éªŒè¯æ ¼ç¥(æ ¼ç¥, å®šå±€å­—, æœ€ç»ˆä½ç½®, scores):
    print("å¼€å§‹éªŒè¯æ ¼ç¥çš„æœ‰æ•ˆæ€§ï¼Œè€ƒè™‘ä½ç½®é¡ºåºã€‚")
    æ ¼ç¥äº”è¡Œ = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[æ ¼ç¥][1]
    # æ‰¾å‡ºæ‰€æœ‰å…‹æˆ–æ³„æ ¼ç¥çš„å­—
    æ€æ‰‹ = []
    ä¿é•– = []
    for å­— in å®šå±€å­—:
        if å­— == æ ¼ç¥:
            continue
        äº”è¡Œå­— = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[å­—][1]
        å…³ç³» = äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡Œå­—, æ ¼ç¥äº”è¡Œ))
        if å…³ç³» in ['å…‹', 'æ³„']:
            æ€æ‰‹.append(å­—)
            print(f"å­—'{å­—}' æ˜¯æ ¼ç¥'{æ ¼ç¥}'çš„æ€æ‰‹ã€‚")
    if not æ€æ‰‹:
        print(f"æ ¼ç¥'{æ ¼ç¥}'æ²¡æœ‰è¢«ä»»ä½•æ€æ‰‹å…‹æˆ–æ³„ã€‚")
        return æ ¼ç¥

    # æ‰¾å‡ºæ€æ‰‹çš„ä¿é•–
    for æ€ in æ€æ‰‹:
        for å­— in å®šå±€å­—:
            if å­— == æ€ or å­— == æ ¼ç¥:
                continue
            äº”è¡Œå­— = åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[å­—][1]
            å…³ç³» = äº”è¡Œä½œç”¨å…³ç³».get((äº”è¡Œå­—, åå¤©å¹²çš„äº”è¡Œå’Œé˜´é˜³è¡¨[æ€][1]))
            if å…³ç³» in ['å…‹', 'æ³„']:
                ä¿é•–.append(å­—)
                print(f"å­—'{å­—}' æ˜¯æ€æ‰‹'{æ€}'çš„ä¿é•–ã€‚")

    # æ¯”è¾ƒä¿é•–å’Œæ€æ‰‹çš„å‡ºç°é¡ºåº
    for æ€ in æ€æ‰‹:
        for ä¿ in ä¿é•–:
            æ€ä½ç½® = ä½ç½®é¡ºåº.get(æœ€ç»ˆä½ç½®.get(æ€, "æ—¶"), 5)
            ä¿ä½ç½® = ä½ç½®é¡ºåº.get(æœ€ç»ˆä½ç½®.get(ä¿, "æ—¶"), 5)
            if ä¿ä½ç½® > ä½ç½®é¡ºåº.get(æœ€ç»ˆä½ç½®.get(æ€, "æ—¶"), 5):
                print(f"ä¿é•–'{ä¿}'çš„å‡ºç°é¡ºåºæ™šäºæ€æ‰‹'{æ€}'ï¼Œæ ¼ç¥'{æ ¼ç¥}'è¢«æ€æ‰‹'{æ€}'æ¶ˆç­ã€‚")
                # æ’é™¤å½“å‰æ ¼ç¥ï¼Œé‡æ–°é€‰æ‹©æ ¼ç¥
                return None
    print(f"æ ¼ç¥'{æ ¼ç¥}'é€šè¿‡ä½ç½®é¡ºåºéªŒè¯ã€‚")
    return æ ¼ç¥

# åº”ç”¨ä½ç½®é¡ºåºéªŒè¯ï¼Œå¹¶é‡æ–°é€‰æ‹©æ ¼ç¥
def ä½ç½®é¡ºåºéªŒè¯(æ ¼ç¥, å®šå±€å­—, æœ€ç»ˆä½ç½®, scores):
    while True:
        éªŒè¯ç»“æœ = éªŒè¯æ ¼ç¥(æ ¼ç¥, å®šå±€å­—, æœ€ç»ˆä½ç½®, scores)
        if éªŒè¯ç»“æœ:
            # éªŒè¯é€šè¿‡ï¼Œæ ¼ç¥æœ‰æ•ˆ
            return éªŒè¯ç»“æœ
        else:
            # éªŒè¯å¤±è´¥ï¼Œé‡æ–°é€‰æ‹©æ ¼ç¥
            # æ’é™¤ä¸Šä¸€ä¸ªæ ¼ç¥
            scores[æ ¼ç¥] = -float('inf')
            print(f"é‡æ–°é€‰æ‹©æ ¼ç¥ï¼Œæ’é™¤'{æ ¼ç¥}'ã€‚")
            # é‡æ–°ç¡®å®šæ ¼ç¥
            åŒç»„åˆ = è¯†åˆ«åŒç»„åˆ(å®šå±€å­—)
            new_æ ¼ç¥_result = ç¡®å®šæ ¼ç¥(å®šå±€å­—, scores, åŒç»„åˆ, æœ€ç»ˆä½ç½®)
            if new_æ ¼ç¥_result.startswith("æ ¼ç¥æ˜¯: "):
                æ ¼ç¥ = new_æ ¼ç¥_result.split(": ")[1]
                print(f"æ–°é€‰æ‹©çš„æ ¼ç¥æ˜¯: {æ ¼ç¥}")
            else:
                # æ— æ³•ç¡®å®šæ ¼ç¥
                return "å®šå±€å­—é‡Œæ²¡æœ‰æ ¼ç¥ğŸ˜•"

# å®šå±€å­—æµ‹è¯•åŠŸèƒ½
def å®šå±€å­—æµ‹è¯•():
    # è·å–ç”¨æˆ·è¾“å…¥çš„å®šå±€å­—
    è¾“å…¥å®šå±€å­— = input("è¯·è¾“å…¥ä½ è¦æµ‹è¯•çš„å®šå±€å­—ï¼ˆè¯·ç”¨ç©ºæ ¼åˆ†éš”ï¼‰ï¼š").strip().split()
    å®šå±€å­— = è¾“å…¥å®šå±€å­—.copy()
    print(f"è¾“å…¥çš„å®šå±€å­—æ˜¯ï¼š{å®šå±€å­—}")

    # è·å–ç”¨æˆ·æ˜¯å¦éœ€è¦è§„åˆ’ä½ç½®é¡ºåº
    è§„åˆ’ä½ç½® = input("è¦ä¸è¦è§„åˆ’ä½ç½®é¡ºåºï¼Ÿï¼ˆå¦‚æœä¸ç”¨ï¼Œç›´æ¥æŒ‰å›è½¦é”®å°±è¡Œã€‚ å¦‚æœéœ€è¦ï¼Œç”¨\"A[æœˆ] B[æ—¥] C[æ—¶]\"è¿™ç§å›ºå®šæ ¼å¼å›å¤ï¼‰ï¼š").strip()
    if è§„åˆ’ä½ç½®:
        # è§£æä½ç½®
        æœ€ç»ˆä½ç½® = {}
        for item in è§„åˆ’ä½ç½®.split():
            if '[' in item and ']' in item:
                å­—, ä½ç½® = item.split('[')
                ä½ç½® = ä½ç½®.rstrip(']')
                if ä½ç½® not in ä½ç½®é¡ºåº:
                    print(f"ä½ç½®'{ä½ç½®}'ä¸åˆæ³•ï¼Œé»˜è®¤è®¾ä¸º[æ—¶]ã€‚")
                    ä½ç½® = "æ—¶"
                æœ€ç»ˆä½ç½®[å­—] = ä½ç½®
            else:
                print(f"è¾“å…¥æ ¼å¼é”™è¯¯çš„é¡¹ï¼š{item}ï¼Œå¿½ç•¥ã€‚")
        print("è¾“å…¥çš„å­—ä½ç½®å¦‚ä¸‹ï¼š")
        for å­—, ä½ç½® in æœ€ç»ˆä½ç½®.items():
            print(f"{å­—}ï¼š[{ä½ç½®}]")
    else:
        # é»˜è®¤æ‰€æœ‰å­—çš„ä½ç½®ä¸º[æ—¶]
        æœ€ç»ˆä½ç½® = {å­—: "æ—¶" for å­— in å®šå±€å­—}
        print("æœªè§„åˆ’ä½ç½®é¡ºåºï¼Œæ‰€æœ‰å­—çš„ä½ç½®è®¾ä¸º[æ—¶]ã€‚")

    # åˆå§‹åŒ–åˆ†æ•°
    scores = åˆå§‹åŒ–åˆ†æ•°(å®šå±€å­—)
    print(f"åˆå§‹åŒ–åˆ†æ•°ï¼š{scores}")

    # åˆå§‹åŒ–ä½œç”¨å€¼
    ä½œç”¨å€¼ = {å­—: 1.0 for å­— in å®šå±€å­—}
    print(f"åˆå§‹åŒ–ä½œç”¨å€¼ï¼š{ä½œç”¨å€¼}")

    # å¤„ç†â€œåŒâ€ç»„åˆ
    åŒç»„åˆ = å¤„ç†åŒç»„åˆ(å®šå±€å­—, scores, ä½œç”¨å€¼)

    # å¦‚æœå¤„ç†â€œåŒâ€ç»„åˆåå·²ç¡®å®šæ²¡æœ‰æ ¼ç¥
    if isinstance(åŒç»„åˆ, str):
        print(åŒç»„åˆ)
        return

    # åº”ç”¨ä½œç”¨è§„åˆ™ï¼Œè¿­ä»£ç›´åˆ°åˆ†æ•°ç¨³å®š
    print("å¼€å§‹è¿­ä»£åº”ç”¨ä½œç”¨è§„åˆ™ï¼Œç›´åˆ°åˆ†æ•°ç¨³å®šã€‚")
    å‰ä¸€æ¬¡åˆ†æ•° = {}
    è¿­ä»£æ¬¡æ•° = 0
    æœ€å¤§è¿­ä»£æ¬¡æ•° = 10
    while å‰ä¸€æ¬¡åˆ†æ•° != scores and è¿­ä»£æ¬¡æ•° < æœ€å¤§è¿­ä»£æ¬¡æ•°:
        å‰ä¸€æ¬¡åˆ†æ•° = scores.copy()
        scores = åº”ç”¨ä½œç”¨(å®šå±€å­—, scores, ä½œç”¨å€¼)
        è¿­ä»£æ¬¡æ•° += 1
        print(f"è¿­ä»£{è¿­ä»£æ¬¡æ•°}åçš„åˆ†æ•°ï¼š{scores}")

    if è¿­ä»£æ¬¡æ•° == æœ€å¤§è¿­ä»£æ¬¡æ•°:
        print("å·²è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œåˆ†æ•°å¯èƒ½æœªå®Œå…¨ç¨³å®šã€‚")

    # ç¡®å®šâ€œæ ¼ç¥â€
    æ ¼ç¥_result = ç¡®å®šæ ¼ç¥(å®šå±€å­—, scores, åŒç»„åˆ, æœ€ç»ˆä½ç½®)
    if æ ¼ç¥_result.startswith("æ ¼ç¥æ˜¯: "):
        æ ¼ç¥ = æ ¼ç¥_result.split(": ")[1]
        # éªŒè¯æ ¼ç¥çš„æœ‰æ•ˆæ€§ï¼Œè€ƒè™‘ä½ç½®é¡ºåº
        æ ¼ç¥ = éªŒè¯æ ¼ç¥(æ ¼ç¥, å®šå±€å­—, æœ€ç»ˆä½ç½®, scores)
        if isinstance(æ ¼ç¥, str):
            print(æ ¼ç¥)
        else:
            print("å®šå±€å­—é‡Œæ²¡æœ‰æ ¼ç¥ğŸ˜•")
    else:
        print(æ ¼ç¥_result)

# ä¸»ç¨‹åºå…¥å£
def ä¸»ç¨‹åº():
    try:
        print("æ¬¢è¿ä½¿ç”¨å®šå±€å­—-æ ¼ç¥åˆ¤å®šç³»ç»Ÿï¼")
        print("è¯·è¾“å…¥å‘½ä¸»çš„ç”Ÿæ—¥ï¼Œæˆ–è¾“å…¥'å®šå±€å­—æµ‹è¯•'è¿›å…¥æµ‹è¯•æ¨¡å¼ã€‚")
        ç”¨æˆ·è¾“å…¥ = input("è¯·è¾“å…¥å‘½ä»¤æˆ–'å®šå±€å­—æµ‹è¯•'ï¼š").strip()
        if ç”¨æˆ·è¾“å…¥ == "å®šå±€å­—æµ‹è¯•":
            å®šå±€å­—æµ‹è¯•()
        else:
            # å‡è®¾ç”¨æˆ·è¾“å…¥çš„æ˜¯å‘½ä¸»ç”Ÿæ—¥ï¼Œå…·ä½“è§£ææ–¹æ³•éœ€æ ¹æ®å®é™…æƒ…å†µå®ç°
            # è¿™é‡Œæˆ‘ä»¬å‡è®¾å·²æœ‰å‡½æ•°æ ¹æ®ç”Ÿæ—¥è®¡ç®—å‡ºâ€œå®šå±€å­—â€å’Œâ€œæœ€ç»ˆä½ç½®â€
            # ä½ éœ€è¦æ ¹æ®å®é™…æƒ…å†µæ›¿æ¢ä¸‹é¢çš„ç¤ºä¾‹ä»£ç 
            # ç¤ºä¾‹ï¼šç”¨æˆ·è¾“å…¥ç”Ÿæ—¥åè‡ªåŠ¨è®¡ç®—â€œå®šå±€å­—â€
            print("ä½ é€‰æ‹©äº†æ™®é€šæ¨¡å¼ï¼Œå¼€å§‹æ ¹æ®ç”Ÿæ—¥è®¡ç®—å®šå±€å­—ã€‚")
            # è¿™é‡Œæ”¾ç½®ä½ å·²æœ‰çš„è®¡ç®—â€œå®šå±€å­—â€çš„ä»£ç 
            # å‡è®¾æœ‰å‡½æ•°å«åš "è®¡ç®—å®šå±€å­—" è¿”å›å®šå±€å­—é›†åˆå’Œæœ€ç»ˆä½ç½®
            å®šå±€å­—é›†åˆ, æœ€ç»ˆä½ç½® = è®¡ç®—å®šå±€å­—()
            print("å®šå±€å­—ï¼š", å®šå±€å­—é›†åˆ)
            print("\næ»¡è¶³æ¡ä»¶çš„æœ€åä¸€ä¸ªä½ç½®ï¼š")
            for å­— in sorted(æœ€ç»ˆä½ç½®.keys()):
                print(f"{å­—}ï¼š{æœ€ç»ˆä½ç½®[å­—]}")

            # åˆå§‹åŒ–åˆ†æ•°
            scores = åˆå§‹åŒ–åˆ†æ•°(å®šå±€å­—é›†åˆ)
            print(f"åˆå§‹åŒ–åˆ†æ•°ï¼š{scores}")

            # åˆå§‹åŒ–ä½œç”¨å€¼
            ä½œç”¨å€¼ = {å­—: 1.0 for å­— in å®šå±€å­—é›†åˆ}
            print(f"åˆå§‹åŒ–ä½œç”¨å€¼ï¼š{ä½œç”¨å€¼}")

            # å¤„ç†â€œåŒâ€ç»„åˆ
            åŒç»„åˆ = å¤„ç†åŒç»„åˆ(å®šå±€å­—é›†åˆ, scores, ä½œç”¨å€¼)

            # å¦‚æœå¤„ç†â€œåŒâ€ç»„åˆåå·²ç¡®å®šæ²¡æœ‰æ ¼ç¥
            if isinstance(åŒç»„åˆ, str):
                print(åŒç»„åˆ)
                return

            # åº”ç”¨ä½œç”¨è§„åˆ™ï¼Œè¿­ä»£ç›´åˆ°åˆ†æ•°ç¨³å®š
            print("å¼€å§‹è¿­ä»£åº”ç”¨ä½œç”¨è§„åˆ™ï¼Œç›´åˆ°åˆ†æ•°ç¨³å®šã€‚")
            å‰ä¸€æ¬¡åˆ†æ•° = {}
            è¿­ä»£æ¬¡æ•° = 0
            æœ€å¤§è¿­ä»£æ¬¡æ•° = 10
            while å‰ä¸€æ¬¡åˆ†æ•° != scores and è¿­ä»£æ¬¡æ•° < æœ€å¤§è¿­ä»£æ¬¡æ•°:
                å‰ä¸€æ¬¡åˆ†æ•° = scores.copy()
                scores = åº”ç”¨ä½œç”¨(å®šå±€å­—é›†åˆ, scores, ä½œç”¨å€¼)
                è¿­ä»£æ¬¡æ•° += 1
                print(f"è¿­ä»£{è¿­ä»£æ¬¡æ•°}åçš„åˆ†æ•°ï¼š{scores}")

            if è¿­ä»£æ¬¡æ•° == æœ€å¤§è¿­ä»£æ¬¡æ•°:
                print("å·²è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œåˆ†æ•°å¯èƒ½æœªå®Œå…¨ç¨³å®šã€‚")

            # ç¡®å®šâ€œæ ¼ç¥â€
            æ ¼ç¥_result = ç¡®å®šæ ¼ç¥(å®šå±€å­—é›†åˆ, scores, åŒç»„åˆ, æœ€ç»ˆä½ç½®)
            if æ ¼ç¥_result.startswith("æ ¼ç¥æ˜¯: "):
                æ ¼ç¥ = æ ¼ç¥_result.split(": ")[1]
                # éªŒè¯æ ¼ç¥çš„æœ‰æ•ˆæ€§ï¼Œè€ƒè™‘ä½ç½®é¡ºåº
                æ ¼ç¥ = éªŒè¯æ ¼ç¥(æ ¼ç¥, å®šå±€å­—é›†åˆ, æœ€ç»ˆä½ç½®, scores)
                if isinstance(æ ¼ç¥, str):
                    print(æ ¼ç¥)
                else:
                    print("å®šå±€å­—é‡Œæ²¡æœ‰æ ¼ç¥ğŸ˜•")
            else:
                print(æ ¼ç¥_result)

    except Exception as e:
        print("è„šæœ¬è¿è¡Œè¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼š", e)
    

# å‡è®¾çš„è®¡ç®—å®šå±€å­—å‡½æ•°ï¼Œæ ¹æ®å®é™…æƒ…å†µå®ç°
def è®¡ç®—å®šå±€å­—():
    # è¿™é‡Œåº”è¯¥æ ¹æ®å‘½ä¸»çš„ç”Ÿæ—¥è®¡ç®—â€œå®šå±€å­—â€å’Œâ€œæœ€ç»ˆä½ç½®â€
    # ç”±äºç¼ºä¹å…·ä½“çš„è®¡ç®—è§„åˆ™ï¼Œä»¥ä¸‹ä¸ºç¤ºä¾‹è¿”å›å€¼
    # è¯·æ ¹æ®å®é™…éœ€æ±‚æ›¿æ¢
    # ç¤ºä¾‹1ï¼šæˆŠã€åºšã€å£¬ã€ç™¸
    # å®šå±€å­—é›†åˆ1 = ["æˆŠ", "åºš", "å£¬", "ç™¸"]
    # æœ€ç»ˆä½ç½®1 = {"æˆŠ": "å¹´", "åºš": "æœˆ", "å£¬": "æ—¥", "ç™¸": "æ—¶"}
    
    # ç¤ºä¾‹2ï¼šæ ¹æ®ç”¨æˆ·è¾“å…¥çš„ç”Ÿæ—¥è®¡ç®—
    # è¿™é‡Œåªæ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå®é™…è®¡ç®—éœ€è¦æ ¹æ®å¹²æ”¯å†æ³•å®ç°
    å®šå±€å­—é›†åˆ = ["æˆŠ", "åºš", "å£¬", "ç™¸"]  # ç¤ºä¾‹
    æœ€ç»ˆä½ç½® = {"æˆŠ": "å¹´", "åºš": "æœˆ", "å£¬": "æ—¥", "ç™¸": "æ—¶"}  # ç¤ºä¾‹
    return å®šå±€å­—é›†åˆ, æœ€ç»ˆä½ç½®



if __name__ == "__main__":
    # ä¸»ç¨‹åºå…¥å£
    options = è§£æè¾“å…¥å‘½ä»¤()
    if options.b:
        æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨, æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨ = æ ¹æ®å¹²æ”¯ç›´æ¥è®¡ç®—å…«å­—(options)
    else:
        æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨, æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨ = æ ¹æ®å…¬å†æ—¥æœŸè®¡ç®—å…«å­—(options)
    # åˆ›å»ºåœ°æ”¯å’Œå¤©å¹²ç»„åˆåˆ—è¡¨
    åœ°æ”¯ç»„åˆ = [æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨.year, æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨.month, æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨.day, æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨.time]
    å¤©å¹²ç»„åˆ = [æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨.year, æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨.month,æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨.day, æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨.time]
    # åˆå§‹åŒ–å·²æ¶ˆå¤±çš„å¤©å¹²å’Œåœ°æ”¯é›†åˆ
    å·²æ¶ˆå¤±å¤©å¹² = set()
    å·²æ¶ˆå¤±åœ°æ”¯ = set()
    # åˆå§‹åŒ–åœ°æ”¯åˆæ¬¡æ•°
    åœ°æ”¯åˆæ¬¡æ•° = {åœ°æ”¯: 0 for åœ°æ”¯ in åœ°æ”¯åˆ—è¡¨}
    # å¤„ç†å››æŸ±ä¹‹é—´çš„å…³ç³»ï¼ˆå…­åˆã€ä¸‰ä¼šã€åˆ‘å†²ç­‰ï¼‰
    æŒ‰é¡ºåºå¤„ç†å››æŸ±å…³ç³»(å¤©å¹²ç»„åˆ, åœ°æ”¯ç»„åˆ, å·²æ¶ˆå¤±å¤©å¹², å·²æ¶ˆå¤±åœ°æ”¯, åœ°æ”¯åˆæ¬¡æ•°)
    # æ˜¾ç¤ºå‘½å±€ä¿¡æ¯
    å‘½å±€æ‰€æœ‰ä¿¡æ¯å±•ç¤º(æœ¬å‘½ç›˜å››ä¸ªå¤©å¹²åå­—åˆ—è¡¨, æœ¬å‘½ç›˜å››ä¸ªåœ°æ”¯åå­—åˆ—è¡¨, options, åœ°æ”¯ç»„åˆ, å·²æ¶ˆå¤±å¤©å¹², å·²æ¶ˆå¤±åœ°æ”¯)

